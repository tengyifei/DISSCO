<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CMOD: bottom.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>bottom.cpp</h1><a href="bottom_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">CMOD (composition module)</span>
00003 <span class="comment">   Copyright (C) 2005  Sever Tipei (s-tipei@uiuc.edu)</span>
00004 <span class="comment"></span>
00005 <span class="comment">   This program is free software; you can redistribute it and/or</span>
00006 <span class="comment">   modify it under the terms of the GNU General Public License</span>
00007 <span class="comment">   as published by the Free Software Foundation; either version 2</span>
00008 <span class="comment">   of the License, or (at your option) any later version.</span>
00009 <span class="comment"></span>
00010 <span class="comment">   This program is distributed in the hope that it will be useful,</span>
00011 <span class="comment">   but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00012 <span class="comment">   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00013 <span class="comment">   GNU General Public License for more details.</span>
00014 <span class="comment"></span>
00015 <span class="comment">   You should have received a copy of the GNU General Public License</span>
00016 <span class="comment">   along with this program; if not, write to the Free Software</span>
00017 <span class="comment">   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
00018 <span class="comment"> */</span>
00019 
00020 <span class="comment">//----------------------------------------------------------------------------//</span>
00021 <span class="comment">// bottom.cpp</span>
00022 <span class="comment">//----------------------------------------------------------------------------//</span>
00023 
00024 <span class="preprocessor">#include "<a class="code" href="bottom_8h.html">bottom.h</a>"</span>
00025 <span class="preprocessor">#include "<a class="code" href="utility_8h.html">utility.h</a>"</span>
00026 <span class="preprocessor">#include "<a class="code" href="note_8h.html">note.h</a>"</span>
00027 
00028 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00029 
<a name="l00030"></a><a class="code" href="bottom_8cpp.html#a0">00030</a> <span class="keyword">extern</span> ofstream * <a class="code" href="bottom_8cpp.html#a0">outputFile</a>;
<a name="l00031"></a><a class="code" href="bottom_8cpp.html#a1">00031</a> <span class="keyword">extern</span> EnvelopeLibrary <a class="code" href="bottom_8cpp.html#a1">envlib</a>;
<a name="l00032"></a><a class="code" href="bottom_8cpp.html#a2">00032</a> <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="bottom_8cpp.html#a2">bottomID</a>;
<a name="l00033"></a><a class="code" href="bottom_8cpp.html#a3">00033</a> <span class="keyword">extern</span> <span class="keywordtype">int</span> <a class="code" href="bottom_8cpp.html#a3">noteID</a>;
<a name="l00034"></a><a class="code" href="bottom_8cpp.html#a4">00034</a> <span class="keyword">extern</span> Score <a class="code" href="bottom_8cpp.html#a4">score</a>;
00035 
00036 <span class="comment">//----------------------------------------------------------------------------//</span>
00037 <span class="comment">// CONSTRUCTOR:  Bottom (Some fundamental information)</span>
00038 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00039"></a><a class="code" href="classBottom.html#a1">00039</a> <a class="code" href="classBottom.html#a0">Bottom::Bottom</a>(<span class="keywordtype">float</span> aStartTime, <span class="keywordtype">float</span> aDuration, <span class="keywordtype">int</span> aType, <span class="keywordtype">char</span> * aName)
00040     :<a class="code" href="classEvent.html">Event</a>(aStartTime, aDuration, aType, aName) {
00041 
00042         <a class="code" href="bottom_8cpp.html#a2">bottomID</a> += 1;
00043         <a class="code" href="classBottom.html#a7">Bottom::setStartTime</a>(aStartTime);
00044         <a class="code" href="classBottom.html#a8">Bottom::setDuration</a>(aDuration);
00045         <a class="code" href="classBottom.html#p3">bottomType</a> = aType;
00046         <a class="code" href="classBottom.html#a6">Bottom::setName</a>(<a class="code" href="classEvent.html#o9">aName</a>);
00047         <a class="code" href="classBottom.html#a9">Bottom::setDensity</a>(.5);
00048 <span class="comment">//  Bottom::setNumPartials(aNumPartials);   // Changing NumPart and Spectrum to new code</span>
00049                         <span class="comment">// This will be needed, but is temp right now</span>
00050     }
00051 
00052 
00053 <span class="comment">//----------------------------------------------------------------------------//</span>
00054 <span class="comment">// CONSTRUCTOR:  Bottom (copy constructor)</span>
00055 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00056"></a><a class="code" href="classBottom.html#a2">00056</a> <a class="code" href="classBottom.html#a0">Bottom::Bottom</a>(<span class="keyword">const</span> <a class="code" href="classBottom.html">Bottom</a>&amp; origBottom):<a class="code" href="classEvent.html">Event</a>(origBottom) {
00057     <a class="code" href="bottom_8cpp.html#a2">bottomID</a> += 1;
00058     cout &lt;&lt; <span class="stringliteral">"right now copying a bottom level does not work"</span> &lt;&lt; endl;
00059 }
00060 
00061 
00062 <span class="comment">//----------------------------------------------------------------------------//</span>
00063 <span class="comment">// DESTRUCTOR:  ~Bottom</span>
00064 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00065"></a><a class="code" href="classBottom.html#a3">00065</a> <a class="code" href="classBottom.html#a3">Bottom::~Bottom</a>() {
00066 <span class="comment">/*</span>
00067 <span class="comment">       cout &lt;&lt; "Bottom Destructor empty" &lt;&lt; endl;</span>
00068 <span class="comment">   </span>
00069 <span class="comment">       //cout &lt;&lt; "Bottom Destructor empty" &lt;&lt; endl;</span>
00070 <span class="comment">       this-&gt;clear();</span>
00071 <span class="comment">*/</span>
00072 }
00073 
00074 
00075 <span class="comment">//----------------------------------------------------------------------------//</span>
00076 <span class="comment">// STATIC PUBLIC:  clear</span>
00077 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00078"></a><a class="code" href="classBottom.html#a5">00078</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a5">Bottom::clear</a>()  {
00079 
00080     <span class="comment">//Print out location</span>
00081     <span class="comment">//This cout causes a seg fault if nameType has not been intialized to anything</span>
00082     <span class="comment">//cout &lt;&lt; "Bottom::clear - just in" &lt;&lt; " nameType: " &lt;&lt; this-&gt;nameType[0] [0]</span>
00083     <span class="comment">//      &lt;&lt; " maxTypes=" &lt;&lt; maxTypes &lt;&lt; endl;</span>
00084 
00085     <a class="code" href="classEvent.html#a49">TestNameType</a>();
00086 
00087     <span class="comment">// Delete contents of nameType char by char</span>
00088     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o10">nameType</a> != NULL ) {
00089         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; this-&gt;<a class="code" href="classEvent.html#o17">maxTypes</a>; i++) {
00090             cout &lt;&lt; <span class="stringliteral">" (char *) nameType["</span> &lt;&lt; i &lt;&lt; <span class="stringliteral">"] "</span> &lt;&lt; (<span class="keywordtype">char</span> *)
00091         this-&gt;<a class="code" href="classEvent.html#o10">nameType</a>[i] &lt;&lt; endl;
00092             <span class="keyword">delete</span> [] (<span class="keywordtype">char</span> *) this-&gt;<a class="code" href="classEvent.html#o10">nameType</a>[i];
00093         }
00094         cout &lt;&lt; <span class="stringliteral">"   (char **) nameType "</span> &lt;&lt; (<span class="keywordtype">char</span> **) this-&gt;<a class="code" href="classEvent.html#o10">nameType</a> &lt;&lt; endl;
00095         <span class="keyword">delete</span> [] (<span class="keywordtype">char</span> **) this-&gt;<a class="code" href="classEvent.html#o10">nameType</a>;
00096     }
00097 
00098     <span class="comment">// Set pointers to NULL and maxTypes to 0</span>
00099     this-&gt;<a class="code" href="classEvent.html#o10">nameType</a> = NULL;
00100 
00101     <a class="code" href="classEvent.html#o17">maxTypes</a> = 0;
00102 
00103     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o32">layerDens</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classEvent.html#o32">layerDens</a>;
00104     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o33">objsInLayer</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classEvent.html#o33">objsInLayer</a>;
00105     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o34">remainObjs</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classEvent.html#o34">remainObjs</a>;
00106     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o23">typesInLayer</a> !=NULL) <span class="keyword">delete</span> <a class="code" href="classEvent.html#o23">typesInLayer</a>;
00107     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o8">theName</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="classEvent.html#o8">theName</a>;
00108     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o28">starTarray</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="classEvent.html#o28">starTarray</a>;
00109     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o30">probSieveArray</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="classEvent.html#o30">probSieveArray</a>;
00110     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o29">durArray</a> != NULL)  <span class="keyword">delete</span> [] <a class="code" href="classEvent.html#o29">durArray</a>;
00111     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classEvent.html#o31">probDurArray</a> != NULL) <span class="keyword">delete</span> [] <a class="code" href="classEvent.html#o31">probDurArray</a>;
00112     
00113     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o0">bottom_newObjectMethod</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o0">bottom_newObjectMethod</a>;
00114     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o1">bottom_slope</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o1">bottom_slope</a>;
00115     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o2">bottom_freqMethod</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o2">bottom_freqMethod</a>;
00116     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o3">bottom_freqMethod2</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o3">bottom_freqMethod2</a>;
00117     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o4">bottom_absRange</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o4">bottom_absRange</a>;
00118     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o5">bottom_patFile</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o5">bottom_patFile</a>;
00119     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o6">bottom_fundamental</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o6">bottom_fundamental</a>;
00120     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o7">bottom_soundMethod</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o7">bottom_soundMethod</a>;
00121     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o8">bottom_envMethod</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o8">bottom_envMethod</a>;
00122     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o9">bottom_ampMethod</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o9">bottom_ampMethod</a>;
00123     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o10">bottom_rule</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o10">bottom_rule</a>;
00124     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o11">bottom_randFlag</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o11">bottom_randFlag</a>;
00125     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o12">bottom_ampScale</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o12">bottom_ampScale</a>;
00126     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o13">bottom_factor</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o13">bottom_factor</a>;
00127     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o14">bottom_attenuation</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o14">bottom_attenuation</a>;
00128     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o15">bottom_modifier</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o15">bottom_modifier</a>;
00129     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o16">bottom_select</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o16">bottom_select</a>;
00130     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o17">bottom_spatMethod</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o17">bottom_spatMethod</a>;
00131     <span class="keywordflow">if</span>(this-&gt;<a class="code" href="classBottom.html#o18">bottom_reverbMethod</a> != NULL) <span class="keyword">delete</span> <a class="code" href="classBottom.html#o18">bottom_reverbMethod</a>;
00132 
00133 
00134     <span class="comment">// Completion Notification</span>
00135     cout &lt;&lt; <span class="stringliteral">"Bottom::clear - Finished"</span> &lt;&lt; endl;
00136 }
00137 
00138 
00139 <span class="comment">//----------------------------------------------------------------------------//</span>
00140 <span class="comment">// STATIC PUBLIC:  SetName</span>
00141 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00142"></a><a class="code" href="classBottom.html#a6">00142</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a6">Bottom::setName</a>(<span class="keywordtype">char</span> * aName) {
00143     <a class="code" href="classBottom.html#p0">bottomName</a> = aName;
00144 
00145     <span class="comment">// If parameter is null prompt for a string</span>
00146     <span class="keywordflow">if</span>(<a class="code" href="classBottom.html#p0">bottomName</a> == NULL) {
00147         cout &lt;&lt; <span class="stringliteral">"Give me a name"</span> &lt;&lt; endl;
00148         cin &gt;&gt; <a class="code" href="classBottom.html#p0">bottomName</a>;
00149     }
00150 }
00151 
00152 
00153 <span class="comment">//----------------------------------------------------------------------------//</span>
00154 <span class="comment">// STATIC PUBLIC:  SetStartTime</span>
00155 <span class="comment">//----------------------------------------------------------------------------//</span>
00156 
<a name="l00157"></a><a class="code" href="classBottom.html#a7">00157</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a7">Bottom::setStartTime</a>(<span class="keywordtype">float</span> aStartTime) {
00158     <a class="code" href="classBottom.html#p1">bottomStartTime</a> = aStartTime;
00159 }
00160 
00161 
00162 <span class="comment">//----------------------------------------------------------------------------//</span>
00163 <span class="comment">// STATIC PUBLIC:  SetDuration</span>
00164 <span class="comment">//----------------------------------------------------------------------------//</span>
00165 
<a name="l00166"></a><a class="code" href="classBottom.html#a8">00166</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a8">Bottom::setDuration</a>(<span class="keywordtype">float</span> aDuration) {
00167     <a class="code" href="classBottom.html#p2">bottomDuration</a> = aDuration;
00168 }
00169 
00170 
00171 <span class="comment">//----------------------------------------------------------------------------//</span>
00172 <span class="comment">// STATIC PUBLIC:  SetDensity</span>
00173 <span class="comment">//----------------------------------------------------------------------------//</span>
00174 
<a name="l00175"></a><a class="code" href="classBottom.html#a9">00175</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a9">Bottom::setDensity</a>(<span class="keywordtype">double</span> aDensity) {
00176     <a class="code" href="classBottom.html#r0">bottomDensity</a> = aDensity;
00177 }
00178 
00179 <span class="comment">/*</span>
00180 <span class="comment">//----------------------------------------------------------------------------//</span>
00181 <span class="comment">// STATIC PUBLIC:  SetNumPartials</span>
00182 <span class="comment">//----------------------------------------------------------------------------//</span>
00183 <span class="comment"></span>
00184 <span class="comment">void Bottom::setNumPartials(int aNumPartials) {</span>
00185 <span class="comment">    bottomNumPartials = aNumPartials;</span>
00186 <span class="comment">}</span>
00187 <span class="comment">*/</span>
00188 
00198 <span class="comment">//----------------------------------------------------------------------------//</span>
00199 
00200 
<a name="l00201"></a><a class="code" href="classBottom.html#a15">00201</a> <span class="keywordtype">int</span> <a class="code" href="classBottom.html#a15">Bottom::NumPart</a>(<span class="keywordtype">float</span> freq) {
00202 
00203     <span class="keywordtype">int</span> numPartials = int(<a class="code" href="classEvent.html#p2">sound_numPartials</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>());
00204 
00205 
00206 
00207    
00208        <span class="comment">// Decrease numPartials until p &lt; CEILING</span>
00209     <span class="keywordflow">while</span>(numPartials * freq &gt; <a class="code" href="define_8h.html#a2">CEILING</a>) numPartials--;        
00210 
00211 
00212     <span class="keywordflow">if</span>(numPartials &lt;= 0) {
00213         cout &lt;&lt; <span class="stringliteral">"Bottom::NumPart - numPartials = 0"</span> &lt;&lt; <span class="stringliteral">" freq="</span> &lt;&lt; freq &lt;&lt; endl;
00214         cin &gt;&gt; <a class="code" href="main_8cpp.html#a7">sever</a>;
00215     }
00216 
00217     <span class="keywordflow">return</span> numPartials;
00218 }
00219 
00229 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00230"></a><a class="code" href="classBottom.html#a16">00230</a> <span class="keywordtype">int</span> <a class="code" href="classBottom.html#a16">Bottom::Spectrum</a>(Sound *s, <span class="keywordtype">float</span> baseFreq) {
00231     <span class="keywordtype">int</span> newNumPartials, offset;
00232     <span class="keywordtype">float</span> deviation;
00233     std::string method;
00234 
00235     newNumPartials = <a class="code" href="classBottom.html#a15">Bottom::NumPart</a>(baseFreq);
00236     <a class="code" href="classBottom.html#a17">Bottom::CreatePartials</a>(s, newNumPartials);
00237 
00238     deviation = <a class="code" href="classEvent.html#p3">sound_deviation</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>();
00239     <a class="code" href="classBottom.html#a18">Bottom::SetFrequency</a>(s, deviation, baseFreq, newNumPartials);
00240 
00241     method = <a class="code" href="classBottom.html#o7">bottom_soundMethod</a>-&gt;<a class="code" href="classFileValue.html#a5">getString</a>();
00242 
00243     <span class="keywordflow">if</span>(method == <span class="stringliteral">"ONE_STEP"</span>) {
00244         <a class="code" href="classBottom.html#a19">Bottom::OneStep</a>(s, <a class="code" href="classEvent.html#o0">checkPoint</a>, newNumPartials);
00245     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(method == <span class="stringliteral">"THREE_STEP"</span>) {
00246         <a class="code" href="classBottom.html#a20">Bottom::ThreeStep</a>(s, <a class="code" href="classEvent.html#o0">checkPoint</a>, newNumPartials);
00247     } <span class="keywordflow">else</span> { 
00248         cout &lt;&lt; <span class="stringliteral">"Bottom::Spectrum - NO method specified for envelopes"</span> &lt;&lt; endl;
00249         cin &gt;&gt; <a class="code" href="main_8cpp.html#a7">sever</a>;
00250     }
00251 
00252     <span class="keywordflow">return</span> newNumPartials;
00253 }
00254 
00255 
00263 <span class="comment">//----------------------------------------------------------------------------//</span>
00264 
<a name="l00265"></a><a class="code" href="classBottom.html#a17">00265</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a17">Bottom::CreatePartials</a>(Sound *s, <span class="keywordtype">int</span> numPartials) {
00266 
00267     <span class="comment">// for each numpartial, create partical, set params, and add to sound.</span>
00268     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00269         Partial p;
00270 
00271         p.setParam(PARTIAL_NUM, i);
00272         s-&gt;add(p);
00273     }
00274 }
00275 
00276 
00289 <span class="comment">//----------------------------------------------------------------------------//</span>
00290 
<a name="l00291"></a><a class="code" href="classBottom.html#a18">00291</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a18">Bottom::SetFrequency</a>(Sound *s, <span class="keywordtype">float</span> deviation, <span class="keywordtype">float</span> baseFreq, 
00292         <span class="keywordtype">int</span> numPartials) {
00293     <span class="keywordtype">float</span> pDev, freq;
00294 
00295     <span class="comment">// Debuging output</span>
00296     <span class="comment">//cout &lt;&lt; "Bottom::SetFrequency - deviation=" &lt;&lt; deviation &lt;&lt; endl;</span>
00297 
00298     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00299 
00300     <span class="comment">// assign frequency to each partial</span>
00301         pDev = deviation * (<a class="code" href="classRandom.html#e1">Random::Rand</a>() - 0.5) * 2;
00302         freq = baseFreq * ((i + 1) + pDev);
00303 
00304     <span class="comment">// if freq is out of range then set it to the closer of the max or min value</span>
00305         <span class="keywordflow">if</span>(freq &lt; <a class="code" href="define_8h.html#a3">MINFREQ</a>) {
00306             freq = <a class="code" href="define_8h.html#a3">MINFREQ</a>;
00307         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(freq &gt; <a class="code" href="define_8h.html#a2">CEILING</a>) {
00308             freq = <a class="code" href="define_8h.html#a2">CEILING</a>;
00309         }
00310 
00311     <span class="comment">// set the frequency of the i_th partial of s to the freq we just created</span>
00312         s-&gt;get(i).setParam(FREQUENCY, freq);
00313     }
00314     <span class="comment">//cin &gt;&gt; sever;</span>
00315 }
00316 
00317 
00328 <span class="comment">//----------------------------------------------------------------------------//</span>
00329 
<a name="l00330"></a><a class="code" href="classBottom.html#a19">00330</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a19">Bottom::OneStep</a>(Sound *s, <span class="keywordtype">double</span> checkPoint, <span class="keywordtype">int</span> numPartials) {
00331     <span class="keywordtype">int</span> offset;
00332     <span class="keywordtype">double</span> check;
00333 
00334     Envelope *env;
00335 
00336     <span class="comment">// Set an offset</span>
00337     offset = <a class="code" href="utility_8cpp.html#a18">ChooseOffset</a>(<a class="code" href="classEvent.html#o44">newObj</a>, <a class="code" href="classEvent.html#o45">type</a>);
00338 
00339     <span class="comment">// for each partial, compute check, build an envelope and set the sounds wave_shape parameter</span>
00340     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00341 
00342     <span class="comment">// EnvelopeBuilder appears to use old code</span>
00343         env = <a class="code" href="utility_8h.html#a19">EnvelopeBuilder</a>(<span class="stringliteral">"FROM_LIB_FIT"</span>, NULL, NULL, checkPoint, offset, 0, 0);
00344         s-&gt;get(i).setParam(WAVE_SHAPE, *env);
00345     }
00346 
00347 }
00348 
00349 
00359 <span class="comment">//----------------------------------------------------------------------------//</span>
00360 
00361 
<a name="l00362"></a><a class="code" href="classBottom.html#a20">00362</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a20">Bottom::ThreeStep</a>(Sound *s, <span class="keywordtype">double</span> checkPoint, <span class="keywordtype">int</span> numPartials) {
00363 
00364     <span class="keywordtype">int</span> numEnv[numPartials], records;
00365     <span class="keywordtype">float</span> ampScale[numPartials];
00366     std::string envMethod;
00367     std::string ampMethod;
00368 
00369     <span class="comment">// get the envelop method and store it in a variable</span>
00370     envMethod = <a class="code" href="classBottom.html#o8">bottom_envMethod</a>-&gt;<a class="code" href="classFileValue.html#a5">getString</a>();              
00371     <span class="comment">//cout &lt;&lt; "            method:" &lt;&lt; method &lt;&lt; endl;</span>
00372 
00373     <span class="comment">// create envelope</span>
00374     Envelope *env;                  
00375 
00376     <span class="comment">// assign a number to each partials envelope based on the envelope method</span>
00377     <span class="keywordflow">if</span>(envMethod == <span class="stringliteral">"SEQUENCE"</span>) {
00378         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00379             numEnv[i] = (<span class="keywordtype">int</span>)<a class="code" href="utility_8cpp.html#a19">Sequence</a>(i);
00380         }
00381     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(envMethod == <span class="stringliteral">"RANGE"</span>) {
00382         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00383         <span class="comment">//DAVID - not sure how to use the new version of ValuePick here</span>
00384             numEnv[i] = <a class="code" href="utility_8cpp.html#a2">ValuePick</a>(checkPoint, <a class="code" href="classBottom.html#o4">bottom_absRange</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>());
00385         }
00386     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(envMethod == <span class="stringliteral">"LIST_START"</span>) {
00387         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00388             numEnv[i] = static_cast&lt;int&gt;(<a class="code" href="classBottom.html#o4">bottom_absRange</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>()) + i;
00389         }
00390     } <span class="keywordflow">else</span> {
00391     <span class="comment">// display error message</span>
00392         cout &lt;&lt; <span class="stringliteral">"Bottom::ThreeStep - no method for partial envelolpes"</span> &lt;&lt; endl;
00393         cin &gt;&gt; <a class="code" href="main_8cpp.html#a7">sever</a>;
00394     }
00395 
00396     <span class="comment">// get the amplitude method</span>
00397     ampMethod = <a class="code" href="classBottom.html#o9">bottom_ampMethod</a>-&gt;<a class="code" href="classFileValue.html#a5">getString</a>();              
00398 
00399     <span class="comment">// assign the amplitude scale for each envelope based on the amplitude method</span>
00400     <span class="keywordflow">if</span>(ampMethod == <span class="stringliteral">"SEQUENCE"</span>) {
00401         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00402             ampScale[i] = <a class="code" href="utility_8cpp.html#a19">Sequence</a>(i);
00403         }
00404     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ampMethod == <span class="stringliteral">"RANGE"</span>) {
00405     std::list&lt;FileValue&gt; tempAmpScaleList = <a class="code" href="classBottom.html#o12">bottom_ampScale</a>-&gt;<a class="code" href="classFileValue.html#a7">getList</a>();
00406         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00407         <a class="code" href="classFileValue.html">FileValue</a> temp;
00408         temp = tempAmpScaleList.front(); 
00409         tempAmpScaleList.pop_front();
00410             ampScale[i] = temp.<a class="code" href="classFileValue.html#a6">getNumber</a>();
00411     }
00412     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(ampMethod == <span class="stringliteral">"RULE"</span>) {
00413         <a class="code" href="classBottom.html#a21">Bottom::Rules</a>(numPartials, ampScale);
00414     } <span class="keywordflow">else</span> {
00415     <span class="comment">// display error message</span>
00416         cout &lt;&lt; <span class="stringliteral">"Bottom::ThreeStep - no method for partial amplitudes"</span> &lt;&lt; endl;
00417         cin &gt;&gt; <a class="code" href="main_8cpp.html#a7">sever</a>;
00418     }
00419 
00420     <span class="comment">// assign the wave shape parameter to each partial using the envelops and ampscale we just found</span>
00421     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00422         env = <a class="code" href="bottom_8cpp.html#a1">envlib</a>.getEnvelope(numEnv[i]);
00423         env-&gt;scale(ampScale[i]);
00424         s-&gt;get(i).setParam(WAVE_SHAPE, *env);
00425     }
00426 }
00427 
00428 
00437 <span class="comment">//----------------------------------------------------------------------------//</span>
00438 
<a name="l00439"></a><a class="code" href="classBottom.html#a21">00439</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a21">Bottom::Rules</a>(<span class="keywordtype">int</span> numPartials, <span class="keywordtype">float</span> ampScale[]) {
00440 
00441     <span class="keywordtype">float</span> attenuation, factor;
00442     <span class="keywordtype">double</span> extra;
00443     std::string rule;
00444     std::string randFlag;
00445 
00446     <span class="comment">// get the string for the rule and the randflag</span>
00447     rule = <a class="code" href="classBottom.html#o10">bottom_rule</a>-&gt;<a class="code" href="classFileValue.html#a5">getString</a>();
00448     randFlag = <a class="code" href="classBottom.html#o11">bottom_randFlag</a>-&gt;<a class="code" href="classFileValue.html#a5">getString</a>();
00449 
00450     <span class="comment">// assign the random extra term deviation for the exponetial function based on the randflag string</span>
00451     <span class="keywordflow">if</span>(randFlag == <span class="stringliteral">"STRAIGHT"</span>) extra = 0.;
00452     <span class="keywordflow">if</span>(randFlag == <span class="stringliteral">"RANDOM"</span>) extra = <a class="code" href="classRandom.html#e1">Random::Rand</a>(<a class="code" href="classRandom.html#w3w2">Random::RAND_SIGN</a>);
00453 
00454     <span class="comment">// assign the ampscales of the partials based on the rule string</span>
00455     <span class="keywordflow">if</span>(rule == <span class="stringliteral">"EXPONENTIAL"</span>) {  
00456         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00457             ampScale[i] = <a class="code" href="utility_8cpp.html#a30">Exponential</a>(i, extra);        <span class="comment">//utility</span>
00458         }
00459     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(rule == <span class="stringliteral">"FIBONACCI"</span>) {
00460         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00461             <span class="keywordflow">if</span>(randFlag == <span class="stringliteral">"RANDOM"</span>) extra = <a class="code" href="classRandom.html#e1">Random::Rand</a>(<a class="code" href="classRandom.html#w3w2">Random::RAND_SIGN</a>);
00462         }
00463     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(rule == <span class="stringliteral">"CONSTANT"</span>) {
00464         <span class="comment">// assign the constant values to be used for this iteration</span>
00465         ampScale[0] = <a class="code" href="classBottom.html#o12">bottom_ampScale</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>();
00466         factor = <a class="code" href="classBottom.html#o13">bottom_factor</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>();
00467         attenuation = <a class="code" href="classBottom.html#o14">bottom_attenuation</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>();
00468 
00469     <span class="comment">// assign the ampscale using numbers which increase at a constant rate</span>
00470         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; numPartials; i++) {
00471             <span class="keywordflow">if</span>(randFlag == <span class="stringliteral">"RANDOM"</span>) extra = <a class="code" href="classRandom.html#e1">Random::Rand</a>(<a class="code" href="classRandom.html#w3w2">Random::RAND_SIGN</a>);
00472             ampScale[i] = ampScale[0] * pow(factor, i);
00473             ampScale[i] += (extra * ampScale[i] * attenuation);
00474         }
00475     } <span class="keywordflow">else</span> {
00476         <span class="comment">// display error message</span>
00477         cout &lt;&lt; <span class="stringliteral">"no rule available"</span> &lt;&lt; endl;
00478         cin &gt;&gt; <a class="code" href="main_8cpp.html#a7">sever</a>;
00479     }
00480 }
00481 
00482 
00491 <span class="comment">//----------------------------------------------------------------------------//</span>
00492 
<a name="l00493"></a><a class="code" href="classBottom.html#a22">00493</a> <span class="keywordtype">float</span> <a class="code" href="classBottom.html#a22">Bottom::Loud</a>(Sound *s, <span class="keywordtype">double</span> checkPoint) {
00494     <span class="keywordtype">int</span> offset;
00495     <span class="keywordtype">float</span> loudness;
00496 
00497     <span class="comment">// Retrieve an offset to use to compute a float representing the loudness</span>
00498     <span class="comment">// offset = ChooseOffset(newObj, type);</span>
00499     <span class="comment">//loudness = ReadComputeFloat(checkPoint, offset);</span>
00500 
00501     <a class="code" href="classEvent.html#p1">bottom_loudness</a>-&gt;<a class="code" href="classFileValue.html#a23">Evaluate</a>();
00502 
00503     loudness = <a class="code" href="classEvent.html#p1">bottom_loudness</a>-&gt;<a class="code" href="classFileValue.html#a6">getNumber</a>();
00504     s-&gt;setParam(LOUDNESS, loudness);
00505 
00506     <span class="comment">// Debuging output</span>
00507     <span class="comment">//cout &lt;&lt; "Bottom::Loud - loudness=" &lt;&lt; loudness &lt;&lt; " newObj=" &lt;&lt; newObj &lt;&lt;</span>
00508     <span class="comment">// " type=" &lt;&lt; type &lt;&lt; endl;</span>
00509 
00510     <span class="keywordflow">return</span> loudness;
00511 }
00512 
00522 <span class="comment">//----------------------------------------------------------------------------//</span>
00523 
<a name="l00524"></a><a class="code" href="classBottom.html#a23">00524</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a23">Bottom::Modifiers</a>(Sound *s, <span class="keywordtype">int</span> numPartials, <span class="keywordtype">double</span> checkPoint) {
00525     <span class="keywordtype">int</span> from = 0, goFlag = 0, offset, to, value;
00526     <span class="keywordtype">double</span> check;
00527     list&lt;FileValue&gt;::const_iterator itModifiers;
00528     list&lt;FileValue&gt; *modifier_list = <a class="code" href="classBottom.html#o15">bottom_modifier</a>-&gt;<a class="code" href="classFileValue.html#a8">getListPtr</a>();
00529 
00530     std::string select;
00531     select = <a class="code" href="classBottom.html#o16">bottom_select</a>-&gt;<a class="code" href="classFileValue.html#a5">getString</a>();  
00532 
00533     <span class="comment">//create an Envelope</span>
00534     Envelope * env;                         
00535 
00536     <span class="comment">//  interate through all of the modifiers</span>
00537     <span class="keywordflow">for</span>(itModifiers = modifier_list-&gt;begin();
00538             itModifiers != modifier_list-&gt;end();
00539             itModifiers++) {
00540         cout &lt;&lt; <span class="stringliteral">"             "</span> &lt;&lt; itModifiers-&gt;getString() &lt;&lt; <span class="stringliteral">"  "</span>;
00541 
00542     <span class="comment">// set our max value for the next for loop based on the select string</span>
00543         <span class="keywordflow">if</span>(select == <span class="stringliteral">"SOUND"</span>) {
00544             to = 1;
00545         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(select == <span class="stringliteral">"PARTIAL"</span>) {
00546             to = numPartials;
00547         }
00548  
00549         <span class="comment">//go through all partials</span>
00550         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = from; i &lt; to; i++) {         
00551 
00552             <span class="keywordflow">if</span>(i == from || (i &gt; from &amp;&amp; goFlag == 1)) {
00553                 <span class="keywordflow">if</span>(i == from) {
00554             <span class="comment">// ChooseOffset is deprecated</span>
00555                     <span class="comment">//offset = ChooseOffset(newObj, type);</span>
00556             env = <a class="code" href="bottom_8cpp.html#a1">envlib</a>.getEnvelope(i);
00557 
00558                     <span class="keywordflow">if</span>(<a class="code" href="utility_8cpp.html#a26">Chance</a>(goFlag, env)) {
00559                         goFlag = 1; cout &lt;&lt; <span class="charliteral">'\t'</span> &lt;&lt; <span class="stringliteral">" assigned1"</span> &lt;&lt; endl;
00560                     } <span class="keywordflow">else</span> {
00561                         goFlag = 0; cout &lt;&lt; <span class="charliteral">'\t'</span> &lt;&lt; <span class="stringliteral">" failed"</span> &lt;&lt; endl;
00562                     }
00563                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(i &gt; from) {
00564                     goFlag = 1; 
00565                 }
00566 
00567         <span class="comment">// Debug output</span>
00568                 <span class="comment">//      cout &lt;&lt; '\t' &lt;&lt; " assigned2 - goFlag=" &lt;&lt; goFlag &lt;&lt; endl;</span>
00569                 
00570         <span class="keywordflow">if</span>(goFlag == 1) {
00571 
00572             <span class="comment">// check is never used, what is its point</span>
00573             <span class="comment">/* if(to &gt; 1) {</span>
00574 <span class="comment">                        check = (float)i / (float)(to - 1);</span>
00575 <span class="comment">                    } else {</span>
00576 <span class="comment">            // Avoid division by 0</span>
00577 <span class="comment">                        check = 1.;                </span>
00578 <span class="comment">                    }*/</span>
00579 
00580             <span class="comment">//ChooseOffset is deprecated</span>
00581                     <span class="comment">//offset = ChooseOffset(newObj, type);</span>
00582 
00583                     <span class="keywordflow">if</span>(itModifiers-&gt;getString() == <span class="stringliteral">"WAVE_TYPE"</span>) {
00584             <span class="comment">// readcomputeint is not used anymore</span>
00585             <span class="comment">// BECKY - might need ValuePick which I don't know how to use</span>
00586             <span class="comment">//       - However, Value doesn't seem to be used anywhere in this function</span>
00587                         value = <a class="code" href="utility_8cpp.html#a11">ReadComputeInt</a>(checkPoint, offset);
00588                     } <span class="keywordflow">else</span> {
00589             <span class="comment">// EnvelopeBuilder uses old code and needs to be fixed</span>
00590                         env = <a class="code" href="utility_8h.html#a19">EnvelopeBuilder</a>(<span class="stringliteral">"FROM_LIB_FIT"</span>, NULL, NULL, checkPoint,
00591                                 offset, 0, 0);
00592                     }
00593 
00594                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(goFlag == 0) {
00595                     <span class="comment">//NonEnv();</span>
00596                 }
00597 
00598                 <span class="keywordtype">char</span>* modifier = <span class="keyword">new</span> <span class="keywordtype">char</span>[itModifiers-&gt;getString().length() + 1];
00599                 strcpy(modifier, itModifiers-&gt;getString().c_str());
00600                 <span class="keywordflow">if</span>( (select == <span class="stringliteral">"SOUND"</span>) &amp;&amp; (goFlag == 1) ) {
00601                     <a class="code" href="classBottom.html#a24">Bottom::ChooseSoundDynParam</a>(s, modifier, env);
00602                 } <span class="keywordflow">else</span> <span class="keywordflow">if</span>( (select == <span class="stringliteral">"PARTIAL"</span>) &amp;&amp; (goFlag == 1) ) {
00603                     <a class="code" href="classBottom.html#a25">Bottom::ChoosePartialDynParam</a>(s, modifier, env, i);
00604                 }
00605             }
00606         }
00607     }
00608 }
00609 
00610 
00620 <span class="comment">//----------------------------------------------------------------------------//</span>
00621 
<a name="l00622"></a><a class="code" href="classBottom.html#a24">00622</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a24">Bottom::ChooseSoundDynParam</a>(Sound *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *modifier, Envelope *env){
00623     
00624     <span class="comment">// Find out what parameter is to be updated using strcmp</span>
00625     <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQUENCY"</span>) == 0 || strcmp(modifier, <span class="stringliteral">"GLISSANDO"</span>) == 0
00626             || strcmp(modifier, <span class="stringliteral">"DETUNE"</span>) == 0 || strcmp(modifier, <span class="stringliteral">"BEND"</span>) == 0){
00627         s-&gt;setPartialParam(FREQ_ENV, *env);
00628 
00629     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"TREMOLO_AMP"</span>) == 0) {
00630         s-&gt;setPartialParam(TREMOLO_AMP, *env);
00631     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"TREMOLO_RATE"</span>) == 0) {
00632         s-&gt;setPartialParam(TREMOLO_RATE, *env);
00633     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"VIBRATO_AMP"</span>) == 0) {
00634         s-&gt;setPartialParam(VIBRATO_AMP, *env);
00635     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"VIBRATO_RATE"</span>) == 0) {
00636         s-&gt;setPartialParam(VIBRATO_RATE, *env);
00637     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"PHASE"</span>) == 0) {
00638         s-&gt;setPartialParam(PHASE, *env);
00639     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"AMPTRANS_AMP_ENV"</span>) == 0) {
00640         s-&gt;setPartialParam(AMPTRANS_AMP_ENV, *env);
00641     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"AMPTRANS_RATE_ENV"</span>) == 0) {
00642         s-&gt;setPartialParam(AMPTRANS_RATE_ENV, *env);
00643     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQTRANS_AMP_ENV"</span>) == 0) {
00644         s-&gt;setPartialParam(FREQTRANS_AMP_ENV, *env);
00645     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQTRANS_RATE_ENV"</span>) == 0) {
00646         s-&gt;setPartialParam(FREQTRANS_RATE_ENV, *env);
00647     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"AMPTRANS_WIDTH"</span>) == 0) {
00648         s-&gt;setPartialParam(AMPTRANS_WIDTH, *env);
00649     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQTRANS_WIDTH"</span>) == 0) {
00650         s-&gt;setPartialParam(FREQTRANS_WIDTH, *env);
00651     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"WAVE_TYPE"</span>) == 0) {
00652         s-&gt;setPartialParam(WAVE_TYPE, env-&gt;getValue(<a class="code" href="classEvent.html#o0">checkPoint</a>, 1));
00653     } <span class="keywordflow">else</span> {
00654         cout &lt;&lt; <span class="stringliteral">"ChoosePartialDynParam - Modifier unknown:"</span> &lt;&lt;
00655             modifier &lt;&lt; endl;
00656     }
00657 }
00658 
00670 <span class="comment">//----------------------------------------------------------------------------//</span>
00671 
<a name="l00672"></a><a class="code" href="classBottom.html#a25">00672</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a25">Bottom::ChoosePartialDynParam</a>(Sound *s, <span class="keyword">const</span> <span class="keywordtype">char</span> *modifier, Envelope *env, 
00673         <span class="keywordtype">int</span> i) {
00674 
00675     <span class="comment">// Find out what parameter is to be updated using strcmp</span>
00676     <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQUENCY"</span>) == 0 || strcmp(modifier, <span class="stringliteral">"GLISSANDO"</span>) == 0
00677             || strcmp(modifier, <span class="stringliteral">"DETUNE"</span>) == 0 || strcmp(modifier, <span class="stringliteral">"BEND"</span>) == 0){
00678         s-&gt;get(i).setParam(FREQ_ENV, *env);
00679 
00680     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"TREMOLO_AMP"</span>) == 0) {
00681         s-&gt;get(i).setParam(TREMOLO_AMP, *env);
00682     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"TREMOLO_RATE"</span>) == 0) {
00683         s-&gt;get(i).setParam(TREMOLO_RATE, *env);
00684     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"VIBRATO_AMP"</span>) == 0) {
00685         s-&gt;get(i).setParam(VIBRATO_AMP, *env);
00686     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"VIBRATO_RATE"</span>) == 0) {
00687         s-&gt;get(i).setParam(VIBRATO_RATE, *env);
00688 
00689     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"PHASE"</span>) == 0) {
00690         s-&gt;get(i).setParam(PHASE, *env);
00691 
00692     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"WAVE_SHAPE"</span>) == 0) {
00693         s-&gt;get(i).setParam(WAVE_SHAPE, *env);
00694 
00695     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"AMPTRANS_AMP_ENV"</span>) == 0) {
00696         s-&gt;get(i).setParam(AMPTRANS_AMP_ENV, *env);
00697     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"AMPTRANS_RATE_ENV"</span>) == 0) {
00698         s-&gt;get(i).setParam(AMPTRANS_RATE_ENV, *env);
00699     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQTRANS_AMP_ENV"</span>) == 0) {
00700         s-&gt;get(i).setParam(FREQTRANS_AMP_ENV, *env);
00701     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQTRANS_RATE_ENV"</span>) == 0) {
00702         s-&gt;get(i).setParam(FREQTRANS_RATE_ENV, *env);
00703     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"AMPTRANS_WIDTH"</span>) == 0) {
00704         s-&gt;get(i).setParam(AMPTRANS_WIDTH, *env);
00705     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(strcmp(modifier, <span class="stringliteral">"FREQTRANS_WIDTH"</span>) == 0) {
00706         s-&gt;get(i).setParam(FREQTRANS_WIDTH, *env);
00707     } <span class="keywordflow">else</span> {
00708         cout &lt;&lt; <span class="stringliteral">"ChoosePartialDynParam - Modifier unknown:"</span> &lt;&lt; 
00709             modifier &lt;&lt; endl;
00710     }
00711 }
00712 
00713 
00725 <span class="comment">//----------------------------------------------------------------------------//</span>
00726 
<a name="l00727"></a><a class="code" href="classBottom.html#a27">00727</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a26">Bottom::Spatialization</a>( Sound *s, <span class="keywordtype">double</span> checkPoint, string method, 
00728                              Envelope *chance, Envelope *pan){
00729     <span class="keywordtype">int</span> goFlag = 0, offset;
00730     <span class="keywordtype">float</span> age, probability;
00731 
00732     <span class="comment">// Debugging code</span>
00733     cout &lt;&lt; <span class="stringliteral">"             "</span> &lt;&lt; method;
00734 
00735     <span class="keywordflow">if</span>(method == <span class="stringliteral">"STEREO"</span>) {
00736 
00737     <span class="comment">// Use chance to randomly enter if statement</span>
00738         <span class="keywordflow">if</span>(<a class="code" href="utility_8cpp.html#a26">Chance</a>(checkPoint, chance)) {
00739 
00740         <span class="comment">// BECKY - What is the perpose of age?  Doesn't seem to do anything.</span>
00741             <span class="comment">// age must be at least 1 otherwise age =  numobjs - 1</span>
00742             <span class="keywordflow">if</span>(<a class="code" href="classEvent.html#o21">numObjs</a> == 1) {              
00743                 age = 1;
00744             } <span class="keywordflow">else</span> {
00745                 age = <a class="code" href="classEvent.html#o21">numObjs</a> - 1;
00746             }
00747 
00748             Pan stereo(* pan);
00749             s-&gt;setSpatializer (stereo);
00750             cout &lt;&lt; <span class="stringliteral">"       assigned"</span> &lt;&lt; endl;
00751         } <span class="keywordflow">else</span> {
00752             cout &lt;&lt; <span class="stringliteral">"       failed"</span> &lt;&lt; endl;
00753         }
00754 
00755     } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(method == <span class="stringliteral">"MULTI_PAN"</span>) {
00756         cout &lt;&lt; <span class="stringliteral">"Bottom::Spatialization - MULTI_PAN not available yet"</span> &lt;&lt; endl;
00757         cin &gt;&gt; <a class="code" href="main_8cpp.html#a7">sever</a>;
00758     } <span class="keywordflow">else</span> {
00759         cout &lt;&lt; <span class="stringliteral">"Bottom::Spatialization - no such method available"</span> &lt;&lt; endl;
00760         cin &gt;&gt; <a class="code" href="main_8cpp.html#a7">sever</a>;
00761     }
00762 }
00763 
00764 
00777 <span class="comment">//----------------------------------------------------------------------------//</span>
00778 
<a name="l00779"></a><a class="code" href="classBottom.html#a29">00779</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a28">Bottom::Reverberation</a>(Sound *s, <span class="keywordtype">double</span> checkPoint, string method, 
00780                            Envelope *chance, <span class="keywordtype">float</span> roomSize) {
00781   <span class="keywordtype">int</span> offset, goFlag = 0;
00782   <span class="keywordtype">float</span> all_pass_gain, hilow_spread, reverb_delay, reverb_percent;
00783   <span class="keywordtype">float</span> probability;
00784 
00785   Envelope * env;
00786 
00787   <span class="comment">// BECKY - why do they pass in method if we just retrieve it ourselves?</span>
00788   method = <a class="code" href="classBottom.html#o18">bottom_reverbMethod</a>-&gt;<a class="code" href="classFileValue.html#a5">getString</a>();
00789   cout &lt;&lt; <span class="stringliteral">"             "</span> &lt;&lt; method;
00790 
00791   <span class="comment">// Use method to determine how we create the reverberation</span>
00792   <span class="keywordflow">if</span>(method == <span class="stringliteral">"ROOM_SIZE"</span>) {
00793     
00794     <span class="comment">// Use chance to randomly enter the if statement</span>
00795     <span class="keywordflow">if</span>(<a class="code" href="utility_8cpp.html#a26">Chance</a>(checkPoint, chance)) {
00796 
00797       <span class="comment">// Create a new reverb obj and assign to use_reverb on s</span>
00798       Reverb *reverbObj = <span class="keyword">new</span> Reverb(roomSize, SAMPLING_RATE);
00799       s-&gt;use_reverb(reverbObj);
00800 
00801       <span class="comment">// Debuging code</span>
00802       cout &lt;&lt; <span class="stringliteral">"         assigned"</span> &lt;&lt; endl;
00803 
00804     } <span class="keywordflow">else</span> {
00805       cout &lt;&lt; <span class="stringliteral">"     failed"</span> &lt;&lt; endl;
00806     }
00807 
00808   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(method == <span class="stringliteral">"CUSTOM"</span>) {
00809 
00810 <span class="comment">/*  THIS IS THE PART THAT USES THE OLD CODING METHOD</span>
00811 <span class="comment">    offset = ChooseOffset(newObj, type);</span>
00812 <span class="comment"></span>
00813 <span class="comment">    reverb_percent = ReadComputeFloat(checkPoint, offset);  //this should be env!!</span>
00814 <span class="comment"></span>
00815 <span class="comment">    hilow_spread = ReadComputeFloat(checkPoint, newObj);</span>
00816 <span class="comment">    all_pass_gain = ReadComputeFloat(checkPoint, newObj);</span>
00817 <span class="comment">    reverb_delay = ReadComputeFloat(checkPoint, newObj);</span>
00818 <span class="comment">*/</span>
00819     <span class="comment">// Use chance to randomly enter the if statement</span>
00820     <span class="keywordflow">if</span>(<a class="code" href="utility_8cpp.html#a26">Chance</a>(goFlag, checkPoint, offset)) {
00821 <span class="comment">/*</span>
00822 <span class="comment">      hilow_spread = ReadComputeFloat(checkPoint, offset);</span>
00823 <span class="comment">      all_pass_gain = ReadComputeFloat(checkPoint, offset);</span>
00824 <span class="comment">      reverb_delay = ReadComputeFloat(checkPoint, offset);</span>
00825 <span class="comment"></span>
00826 <span class="comment">      Reverb *reverbObj = new Reverb(reverb_percent, hilow_spread, all_pass_gain, </span>
00827 <span class="comment">       reverb_delay, SAMPLING_RATE);</span>
00828 <span class="comment">      s-&gt;use_reverb(reverbObj);</span>
00829 <span class="comment">*/</span>
00830     }
00831   } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(method == <span class="stringliteral">"SINGLE_PARTIAL"</span>) {
00832     
00833     cout &lt;&lt; <span class="stringliteral">"Bottom::Reverberation - SINGLE_PARTIAL method not available yet"</span> 
00834      &lt;&lt; endl;
00835 
00836   } <span class="keywordflow">else</span> {
00837     cout &lt;&lt; <span class="stringliteral">"Bottom::Reverberation - no such method available"</span> &lt;&lt; endl;
00838   }
00839 }
00840 
00846 <span class="comment">//----------------------------------------------------------------------------//</span>
00847 
<a name="l00848"></a><a class="code" href="classBottom.html#a30">00848</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a30">Bottom::Print</a>() {
00849 
00850     *<a class="code" href="bottom_8cpp.html#a0">outputFile</a> &lt;&lt; <span class="stringliteral">"--------------------------------------------------------------"</span>     &lt;&lt; endl;
00851     *<a class="code" href="bottom_8cpp.html#a0">outputFile</a> &lt;&lt; <span class="stringliteral">"    |BOTTOM "</span> &lt;&lt; <a class="code" href="bottom_8cpp.html#a2">bottomID</a>&lt;&lt; <span class="stringliteral">":  "</span> &lt;&lt; <a class="code" href="classEvent.html#o8">theName</a> &lt;&lt; endl;
00852     *<a class="code" href="bottom_8cpp.html#a0">outputFile</a> &lt;&lt; <span class="stringliteral">"    |  StartTime:  "</span> &lt;&lt; setw(7)&lt;&lt; <a class="code" href="classEvent.html#o5">theStartTime</a> * <a class="code" href="classEvent.html#o15">uPerSec</a> &lt;&lt; 
00853         <span class="stringliteral">" units  "</span> &lt;&lt; setw(8) &lt;&lt; <a class="code" href="classEvent.html#o5">theStartTime</a> &lt;&lt; setw(4) &lt;&lt; <span class="stringliteral">"sec"</span> &lt;&lt; endl;
00854     *<a class="code" href="bottom_8cpp.html#a0">outputFile</a> &lt;&lt; <span class="stringliteral">"    |  Duration:   "</span> &lt;&lt; setw(7) &lt;&lt; <a class="code" href="classEvent.html#o6">theDuration</a> * <a class="code" href="classEvent.html#o15">uPerSec</a> &lt;&lt; 
00855         <span class="stringliteral">" units  "</span> &lt;&lt; setw(8) &lt;&lt; <a class="code" href="classEvent.html#o6">theDuration</a> &lt;&lt; setw(4) &lt;&lt;<span class="stringliteral">"sec"</span> &lt;&lt; endl;
00856     <span class="comment">//*outputFile &lt;&lt; "    |  Density:    " &lt;&lt; theDensity  &lt;&lt; endl;</span>
00857 
00858 }
00859 
00869 <span class="comment">//----------------------------------------------------------------------------//</span>
00870 
<a name="l00871"></a><a class="code" href="classBottom.html#a31">00871</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a31">Bottom::PrintSound</a>(<span class="keywordtype">int</span> numPartials, <span class="keywordtype">float</span> freq, <span class="keywordtype">float</span> sones) {
00872 
00873     *<a class="code" href="bottom_8cpp.html#a0">outputFile</a> &lt;&lt; <span class="stringliteral">"--------------------------------------------------------"</span>   &lt;&lt; endl;
00874     *<a class="code" href="bottom_8cpp.html#a0">outputFile</a> &lt;&lt; <span class="stringliteral">"          Sound "</span> &lt;&lt; <a class="code" href="classEvent.html#o22">objID</a>&lt;&lt; <span class="stringliteral">":  start time "</span> &lt;&lt; <a class="code" href="classEvent.html#o40">stimeSec</a> &lt;&lt;
00875         <span class="stringliteral">" duration "</span> &lt;&lt; <a class="code" href="classEvent.html#o39">durSec</a>  &lt;&lt; <span class="stringliteral">"       type "</span> &lt;&lt; <a class="code" href="classEvent.html#o45">type</a> &lt;&lt; endl;
00876     *<a class="code" href="bottom_8cpp.html#a0">outputFile</a> &lt;&lt; <span class="stringliteral">"                  has "</span>&lt;&lt; numPartials &lt;&lt; <span class="stringliteral">" partials"</span> &lt;&lt; 
00877         <span class="stringliteral">" frequency="</span> &lt;&lt; freq &lt;&lt; <span class="stringliteral">" sones="</span> &lt;&lt; sones &lt;&lt; endl;
00878 }
00879 
00880 
00887 <span class="comment">//----------------------------------------------------------------------------//</span>
00888 
<a name="l00889"></a><a class="code" href="classBottom.html#a13">00889</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a13">Bottom::buildSound</a>(Score *score){
00890     <span class="keywordtype">float</span> freq, sones, deviation;
00891     <span class="keywordtype">int</span> numPartials;
00892     std::vector&lt;Envelope *&gt; partEnvs;
00893 
00894     <a class="code" href="classFileValue.html">FileValue</a> tmp;
00895     <span class="comment">/*tmp = (*bottom_frequency);</span>
00896 <span class="comment">    tmp.Evaluate(this);</span>
00897 <span class="comment">    freq = (float)tmp.getNumber();*/</span>
00898     freq = (<span class="keywordtype">float</span>)(*bottom_frequency).getNumber();
00899 
00900     <span class="comment">/*tmp = (*bottom_loudness);</span>
00901 <span class="comment">    tmp.Evaluate(this);*/</span>
00902     sones = (<span class="keywordtype">float</span>)(*bottom_loudness).getNumber();
00903 
00904     <span class="comment">/*tmp = (*sound_numPartials);</span>
00905 <span class="comment">    tmp.Evaluate(this);*/</span>
00906     numPartials = (<span class="keywordtype">int</span>)(*sound_numPartials).getNumber();
00907 
00908     <span class="comment">/*tmp = (*sound_deviation);</span>
00909 <span class="comment">    tmp.Evaluate(this);*/</span>
00910     deviation = (<span class="keywordtype">float</span>)(*sound_deviation).getNumber();
00911 
00912     tmp = (*sound_partEnvs);
00913     tmp.<a class="code" href="classFileValue.html#a23">Evaluate</a>(<span class="keyword">this</span>);
00914     std::list&lt;FileValue&gt;::iterator it;
00915     <span class="keywordflow">for</span>(it = tmp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;begin(); 
00916             it != tmp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;end();
00917             it++)
00918     {
00919         it-&gt;Evaluate();
00920         partEnvs.push_back(it-&gt;getEnvelope());
00921     }
00922 
00923     Sound s;
00924     s.setParam(START_TIME, <a class="code" href="classEvent.html#o40">stimeSec</a>);               
00925     s.setParam(DURATION, <a class="code" href="classEvent.html#o39">durSec</a>);   
00926     <span class="keywordtype">float</span> pDev, tmpFreq;
00927 
00928     <span class="comment">//cout &lt;&lt; "Bottom::SetFrequency - deviation=" &lt;&lt; deviation &lt;&lt; endl;</span>
00929     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; numPartials; i++) {
00930         pDev = deviation * (<a class="code" href="classRandom.html#e1">Random::Rand</a>() - 0.5) * 2;
00931         tmpFreq = freq * ((i + 1) + pDev);
00932 
00933         <span class="keywordflow">if</span>(tmpFreq &lt; <a class="code" href="define_8h.html#a3">MINFREQ</a>) {
00934             tmpFreq = <a class="code" href="define_8h.html#a3">MINFREQ</a>;
00935         } <span class="keywordflow">else</span> <span class="keywordflow">if</span>(tmpFreq &gt; <a class="code" href="define_8h.html#a2">CEILING</a>) {
00936             tmpFreq = <a class="code" href="define_8h.html#a2">CEILING</a>;
00937         }
00938         s.get(i).setParam(FREQUENCY, freq);
00939     }
00940 
00941     s.setParam(LOUDNESS, sones);
00942 
00943     <span class="comment">//    std::list&lt;FileValue&gt;::iterator it;</span>
00944     tmp = (*sound_modifiers);
00945     map&lt;string, FileValue&gt; modifiers;
00946     map&lt;string, double&gt; mod_probs;
00947     <span class="keywordflow">for</span>(it = tmp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;begin(); it != tmp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;end();
00948             it++){
00949         <a class="code" href="classFileValue.html">FileValue</a> fv_temp = *it;
00950         fv_temp.<a class="code" href="classFileValue.html#a23">Evaluate</a>();
00951         list&lt;FileValue&gt;::iterator mod_it = fv_temp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;begin();
00952         string mod_name = (*mod_it).getString();
00953         mod_it++;
00954         Envelope *mod_chanceEnv = (*mod_it).getEnvelope();
00955         mod_it++;
00956         Envelope *mod_valueEnv = (*mod_it).getEnvelope();
00957         mod_it++;
00958         string mod_dependancy = (*mod_it).getString();
00959         mod_it++;
00960         <span class="keywordflow">if</span> (mod_it != fv_temp.<a class="code" href="classFileValue.html#a7">getList</a>().end())
00961         {
00962             <span class="keywordtype">int</span> mod_partial = (<span class="keywordtype">int</span>)((*mod_it).getNumber());
00963         }
00964         <span class="comment">// modifiers[mod_name] = fv_temp;</span>
00965         mod_probs[mod_name] = mod_chanceEnv-&gt;getValue(<a class="code" href="classEvent.html#o0">checkPoint</a>, 1);
00966         <span class="comment">// do stuff with modifiers</span>
00967     }
00968 
00969     <span class="keywordflow">for</span>(it = tmp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;begin(); 
00970             it != tmp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;end();
00971             it++)
00972     {
00973         <a class="code" href="classFileValue.html">FileValue</a> fv_temp = *it;
00974         fv_temp.<a class="code" href="classFileValue.html#a23">Evaluate</a>();
00975         list&lt;FileValue&gt;::iterator mod_it = fv_temp.<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;begin();
00976         string mod_name = (*mod_it).getString();
00977         mod_it++;
00978         Envelope *mod_chanceEnv = (*mod_it).getEnvelope();
00979         mod_it++;
00980         Envelope *mod_valueEnv = (*mod_it).getEnvelope();
00981         mod_it++;
00982         string mod_dependancy = (*mod_it).getString();
00983         mod_it++;
00984         <span class="keywordtype">int</span> mod_partial;
00985         <span class="keywordflow">if</span> (mod_it != fv_temp.<a class="code" href="classFileValue.html#a7">getList</a>().end())
00986         {
00987             mod_partial = (<span class="keywordtype">int</span>)((*mod_it).getNumber());
00988         }
00989         <span class="keywordflow">else</span>
00990             mod_partial = -1;
00991 
00992         <span class="keywordtype">double</span> rand = <a class="code" href="classRandom.html#e1">Random::Rand</a>();
00993         <span class="keywordflow">if</span> (rand &lt;= mod_probs[mod_name])
00994         {
00995             mod_probs[mod_name] = 1;
00996             <span class="keywordflow">if</span> (mod_probs[mod_dependancy] == 1)
00997             {
00998                 <span class="comment">// apply various modifiers to sound/partial here</span>
00999                 <span class="keywordflow">if</span> (mod_partial == -1)
01000                 {
01001                     <a class="code" href="classBottom.html#a24">ChooseSoundDynParam</a>(&amp;s, mod_name.c_str(), 
01002                                         mod_valueEnv);
01003                 }
01004                 <span class="keywordflow">else</span>
01005                 {
01006                     <a class="code" href="classBottom.html#a25">ChoosePartialDynParam</a>(&amp;s, mod_name.c_str(),
01007                                           mod_valueEnv,
01008                                           mod_partial);
01009                 }
01010             }
01011             <span class="keywordflow">else</span> 
01012                 mod_probs[mod_name] = 0;
01013         }
01014         <span class="keywordflow">else</span>
01015             mod_probs[mod_name] = 0;
01016     }
01017 
01018     <span class="comment">// Spatialization</span>
01019     <span class="keywordflow">if</span> (<a class="code" href="classEvent.html#p7">sound_spatialization</a> != NULL)
01020     {
01021         list&lt;FileValue&gt;::iterator it = <a class="code" href="classEvent.html#p7">sound_spatialization</a>-&gt;<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;begin();
01022         string spat_method = (*it).getString();
01023         it++;
01024         Envelope *chanceEnv = (*it).getEnvelope();
01025         it++;
01026         Envelope *panEnv = (*it).getEnvelope();
01027         <a class="code" href="classBottom.html#a26">Spatialization</a>(&amp;s, <a class="code" href="classEvent.html#o0">checkPoint</a>, spat_method, chanceEnv, panEnv);
01028     }
01029 
01030     <span class="comment">// Reverberation</span>
01031     <span class="keywordflow">if</span> (<a class="code" href="classEvent.html#p6">sound_reverberation</a> != NULL)
01032     {
01033         list&lt;FileValue&gt;::iterator it =
01034     <a class="code" href="classEvent.html#p6">sound_reverberation</a>-&gt;<a class="code" href="classFileValue.html#a8">getListPtr</a>()-&gt;begin();
01035         string rev_method = (*it).getString();
01036         it++;
01037         Envelope *chanceEnv = (*it).getEnvelope();
01038         it++;
01039         <span class="keywordtype">float</span> roomSize = (<span class="keywordtype">float</span>) (*it).getNumber();
01040         <a class="code" href="classBottom.html#a28">Reverberation</a>(&amp;s, <a class="code" href="classEvent.html#o0">checkPoint</a>, rev_method, chanceEnv, roomSize);
01041     }
01042 
01043     <a class="code" href="bottom_8cpp.html#a4">score</a>-&gt;add(s);
01044 }
01045 
<a name="l01046"></a><a class="code" href="classBottom.html#a32">01046</a> <span class="keywordtype">void</span> <a class="code" href="classBottom.html#a32">Bottom::buildNote</a>()
01047 {
01048    <a class="code" href="classNote.html">Note</a> n(<a class="code" href="classEvent.html#o44">newObj</a>, <a class="code" href="classEvent.html#o45">type</a>, <a class="code" href="classEvent.html#o40">stimeSec</a> - <a class="code" href="classBottom.html#p1">bottomStartTime</a>, <a class="code" href="classEvent.html#o39">durSec</a>, <a class="code" href="classEvent.html#o15">uPerSec</a>, <a class="code" href="classEvent.html#o16">barLen</a>,
01049     <a class="code" href="classEvent.html#p8">note_pitchClass</a>, <a class="code" href="classEvent.html#p9">note_dynamicMark</a>, <a class="code" href="classEvent.html#p10">note_modifiers</a>);
01050    n.<a class="code" href="classNote.html#a16">Activate</a>(<a class="code" href="classEvent.html#o0">checkPoint</a>, <a class="code" href="classEvent.html#o44">newObj</a>, <a class="code" href="classEvent.html#o45">type</a>);
01051    n.<a class="code" href="classNote.html#a15">Print</a>(<a class="code" href="classEvent.html#o44">newObj</a>, <a class="code" href="classEvent.html#o45">type</a>);
01052    <a class="code" href="classEvent.html#a58">Event::buildNote</a>();
01053 }
01054 
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Feb 12 14:24:37 2007 for CMOD by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
