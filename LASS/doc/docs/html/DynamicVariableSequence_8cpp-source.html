<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>LASS: DynamicVariableSequence.cpp Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.4 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="namespaces.html">Namespace List</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Class&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Class&nbsp;Members</a> | <a class="qindex" href="globals.html">File&nbsp;Members</a> | <a class="qindex" href="pages.html">Related&nbsp;Pages</a></div>
<h1>DynamicVariableSequence.cpp</h1><a href="DynamicVariableSequence_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <span class="comment">/*</span>
00002 <span class="comment">LASS (additive sound synthesis library)</span>
00003 <span class="comment">Copyright (C) 2005  Sever Tipei (s-tipei@uiuc.edu)</span>
00004 <span class="comment"></span>
00005 <span class="comment">This program is free software; you can redistribute it and/or</span>
00006 <span class="comment">modify it under the terms of the GNU General Public License</span>
00007 <span class="comment">as published by the Free Software Foundation; either version 2</span>
00008 <span class="comment">of the License, or (at your option) any later version.</span>
00009 <span class="comment"></span>
00010 <span class="comment">This program is distributed in the hope that it will be useful,</span>
00011 <span class="comment">but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
00012 <span class="comment">MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
00013 <span class="comment">GNU General Public License for more details.</span>
00014 <span class="comment"></span>
00015 <span class="comment">You should have received a copy of the GNU General Public License</span>
00016 <span class="comment">along with this program; if not, write to the Free Software</span>
00017 <span class="comment">Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.</span>
00018 <span class="comment">*/</span>
00019 
00020 <span class="comment">//----------------------------------------------------------------------------//</span>
00021 <span class="comment">//</span>
00022 <span class="comment">// DynamicVariableSequence.cpp</span>
00023 <span class="comment">//</span>
00024 <span class="comment">//----------------------------------------------------------------------------//</span>
00025 
00026 <span class="preprocessor">#ifndef __DYNAMIC_VARIABLE_SEQUENCE_CPP</span>
00027 <span class="preprocessor"></span><span class="preprocessor">#define __DYNAMIC_VARIABLE_SEQUENCE_CPP</span>
00028 <span class="preprocessor"></span>
00029 <span class="comment">// #define DEBUG_MODE 1</span>
00030 
00031 <span class="comment">//----------------------------------------------------------------------------//</span>
00032 
00033 <span class="preprocessor">#include "<a class="code" href="DynamicVariableSequence_8h.html">DynamicVariableSequence.h</a>"</span>
00034 <span class="preprocessor">#include "<a class="code" href="DynamicVariableSequenceIterator_8h.html">DynamicVariableSequenceIterator.h</a>"</span>
00035 <span class="preprocessor">#include "<a class="code" href="InterpolatorTypes_8h.html">InterpolatorTypes.h</a>"</span>
00036 
00037 <span class="preprocessor">#include &lt;iomanip&gt;</span>
00038 <span class="preprocessor">#include &lt;math.h&gt;</span>
00039 <span class="keyword">using</span> std::setw;
00040 
00041 
00042 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00043"></a><a class="code" href="classDynamicVariableSequence.html#a0">00043</a> <a class="code" href="classDynamicVariableSequence.html#a0">DynamicVariableSequence::DynamicVariableSequence</a>()
00044 {
00045     <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a> = NULL;
00046     <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a> = NULL;
00047     <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a> = NULL;
00048     <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a> = NULL;
00049     <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> = -1;
00050     <a class="code" href="classDynamicVariableSequence.html#r5">currentInterpolatorRate_</a> = 0;
00051 }
00052 
00053 
<a name="l00054"></a><a class="code" href="classDynamicVariableSequence.html#a1">00054</a> <a class="code" href="classDynamicVariableSequence.html#a0">DynamicVariableSequence::DynamicVariableSequence</a> (<a class="code" href="classDynamicVariableSequence.html">DynamicVariableSequence</a> &amp;dvs)
00055 {
00056     <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a> = dvs.<a class="code" href="classDynamicVariableSequence.html#a10">getPoints</a>();
00057     <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a> = dvs.<a class="code" href="classDynamicVariableSequence.html#a11">getSegments</a>();
00058 
00059     <span class="comment">// there's not an easy way to transfer these, so the copy does not contain</span>
00060     <span class="comment">// the generated interpolators, but these are only stored to help</span>
00061     <span class="comment">// optimize the code</span>
00062     <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a> = NULL;
00063     <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a> = NULL;
00064     <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> = -1;
00065     <a class="code" href="classDynamicVariableSequence.html#r5">currentInterpolatorRate_</a> = 0;
00066 }
00067 
00068 
00069 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00070"></a><a class="code" href="classDynamicVariableSequence.html#a2">00070</a> <a class="code" href="classDynamicVariableSequence.html#a0">DynamicVariableSequence::DynamicVariableSequence</a>(
00071     <a class="code" href="classCollection.html">Collection&lt;xy_point&gt;</a> xyPoints,
00072     <a class="code" href="classCollection.html">Collection&lt;envelope_segment&gt;</a> segments)
00073 {
00074     <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a> = NULL;
00075     <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a> = NULL;
00076     <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a> = NULL;
00077     <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a> = NULL;
00078     <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> = -1;
00079     <a class="code" href="classDynamicVariableSequence.html#r5">currentInterpolatorRate_</a> = 0;
00080 
00081     <span class="comment">// define the shape, given the Collections</span>
00082     <a class="code" href="classDynamicVariableSequence.html#a7">DefineShape</a> (xyPoints, segments);
00083 
00084 }
00085 
00086 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00087"></a><a class="code" href="classDynamicVariableSequence.html#a3">00087</a> <a class="code" href="classDynamicVariableSequence.html#a3">DynamicVariableSequence::~DynamicVariableSequence</a>()
00088 {
00089     <span class="comment">// make sure we don't cause a memory leak</span>
00090     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a> != NULL)
00091     {
00092         <span class="keyword">delete</span> (<a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>);
00093     }
00094     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r1">segments_</a> != NULL)
00095     {
00096         <span class="keyword">delete</span> (<a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>);
00097     }
00098     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a> != NULL)
00099     {
00100         <a class="code" href="classInterpolator.html">Interpolator</a>* interTemp = NULL;
00101 
00102         <span class="comment">// remove each interpolator* from the collection and delete the</span>
00103         <span class="comment">// allocated memory</span>
00104         <span class="keywordflow">while</span> (<a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>() &gt; 0)
00105         {
00106             interTemp = <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a8">remove</a>(0);
00107             <span class="keyword">delete</span> (interTemp);
00108         }
00109 
00110         <span class="keyword">delete</span> (<a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>);
00111     }
00112     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a> != NULL)
00113     {
00114         <span class="keyword">delete</span> (<a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>);
00115     }
00116 }
00117 
00118 
00119 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00120"></a><a class="code" href="classDynamicVariableSequence.html#a6">00120</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a6">DynamicVariableSequence::Print</a>()
00121 {
00122     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r1">segments_</a> == NULL)
00123       {
00124         cout &lt;&lt; <span class="stringliteral">"Envelope has not been initialized.\n"</span>;
00125         <span class="keywordflow">return</span>;
00126       }
00127 
00128     <span class="keywordtype">int</span> iNumSegments = <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>();
00129     <span class="keywordtype">int</span> iLoop = 0;
00130 
00131     cout &lt;&lt; endl;
00132     cout &lt;&lt; <span class="stringliteral">"DVS has "</span> &lt;&lt; iNumSegments &lt;&lt; <span class="stringliteral">" segments."</span> &lt;&lt; endl;
00133 
00134     <span class="keywordflow">for</span> (iLoop = 0; iLoop &lt; iNumSegments; iLoop++)
00135     {
00136         <span class="comment">// print a line with form (x, y):</span>
00137         cout &lt;&lt; <span class="stringliteral">" x, y: "</span> &lt;&lt; <span class="stringliteral">"("</span>;
00138         cout &lt;&lt; setw(5) &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iLoop).<a class="code" href="structxy__point.html#o0">x</a>;
00139         cout &lt;&lt; <span class="stringliteral">", "</span>;
00140         cout &lt;&lt; setw(5) &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iLoop).<a class="code" href="structxy__point.html#o1">y</a>;
00141         cout &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
00142 
00143         <span class="comment">// print the entry number</span>
00144         cout &lt;&lt; <span class="stringliteral">"     Entry "</span> &lt;&lt; iLoop &lt;&lt; <span class="stringliteral">":"</span> &lt;&lt; endl;
00145         
00146         <span class="comment">// print the time type</span>
00147         cout &lt;&lt; <span class="stringliteral">"       Time type: "</span>;
00148         <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classDynamicVariableSequence.html#a20">getSegmentTimeType</a>(iLoop) == <a class="code" href="Types_8h.html#a12a8">FLEXIBLE</a>)
00149         {
00150             cout &lt;&lt; <span class="stringliteral">"FLEXIBLE"</span> &lt;&lt; endl;
00151         }
00152         <span class="keywordflow">else</span>
00153         {
00154             cout &lt;&lt; <span class="stringliteral">"FIXED"</span> &lt;&lt; endl;
00155         }
00156 
00157         <span class="comment">// print the time value</span>
00158         cout &lt;&lt; <span class="stringliteral">"       Time value: "</span>;
00159         cout &lt;&lt; this-&gt;<a class="code" href="classDynamicVariableSequence.html#a18">getSegmentTime</a>(iLoop) &lt;&lt; endl;
00160 
00161         <span class="comment">// print the interpolation type</span>
00162         cout &lt;&lt; <span class="stringliteral">"       Interpolation Type: "</span>;
00163         <span class="keywordflow">switch</span> (this-&gt;<a class="code" href="classDynamicVariableSequence.html#a22">getSegmentInterpolationType</a>(iLoop))
00164         {
00165             <span class="keywordflow">case</span> <a class="code" href="Types_8h.html#a13a11">LINEAR</a>:
00166                 cout &lt;&lt; <span class="stringliteral">"LINEAR"</span> &lt;&lt; endl;
00167                 <span class="keywordflow">break</span>;
00168             <span class="keywordflow">case</span> <a class="code" href="Types_8h.html#a13a9">EXPONENTIAL</a>:
00169                 cout &lt;&lt; <span class="stringliteral">"EXPONENTIAL"</span> &lt;&lt; endl;
00170                 <span class="keywordflow">break</span>;
00171             <span class="keywordflow">case</span> <a class="code" href="Types_8h.html#a13a10">CUBIC_SPLINE</a>:
00172                 cout &lt;&lt; <span class="stringliteral">"CUBIC_SPLINE"</span> &lt;&lt; endl;
00173                 <span class="keywordflow">break</span>;
00174         }
00175     }
00176 
00177     <span class="comment">// output the last point</span>
00178     cout &lt;&lt; <span class="stringliteral">" x, y: "</span> &lt;&lt; <span class="stringliteral">"("</span>;
00179     cout &lt;&lt; setw(5) &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iLoop).<a class="code" href="structxy__point.html#o0">x</a>;
00180     cout &lt;&lt; <span class="stringliteral">", "</span>;
00181     cout &lt;&lt; setw(5) &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iLoop).<a class="code" href="structxy__point.html#o1">y</a>;
00182     cout &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
00183     
00184     cout &lt;&lt; <span class="stringliteral">"End of DVS."</span> &lt;&lt; endl;
00185     cout &lt;&lt; endl;
00186 }
00187 
00188 
00189 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00190"></a><a class="code" href="classDynamicVariableSequence.html#a4">00190</a> <a class="code" href="classDynamicVariableSequence.html">DynamicVariableSequence</a>* <a class="code" href="classDynamicVariableSequence.html#a4">DynamicVariableSequence::clone</a> ()
00191 {
00192     <span class="comment">// give them a new DVS that is made using the current DVS's data</span>
00193     <span class="keywordflow">return</span> (<span class="keyword">new</span> <a class="code" href="classDynamicVariableSequence.html#a0">DynamicVariableSequence</a>(*<a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>, *<a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>));
00194 }
00195 
00196 
00197 <span class="comment">//----------------------------------------------------------------------------//</span>
00198 
<a name="l00199"></a><a class="code" href="classDynamicVariableSequence.html#a5">00199</a> <a class="code" href="Types_8h.html#a3">m_value_type</a> <a class="code" href="classDynamicVariableSequence.html#a5">DynamicVariableSequence::getValue</a> (<a class="code" href="Types_8h.html#a2">m_time_type</a> time,
00200                                                 <a class="code" href="Types_8h.html#a2">m_time_type</a> timeTotal)
00201 {
00202         <span class="keywordflow">if</span> (time &gt; timeTotal || time &lt; 0)
00203         {
00204         <span class="comment">// they are dumb for passing in invalid values, so let them know</span>
00205                 cout &lt;&lt; <span class="stringliteral">"DVS::getValue(...): invalid time or totalTime parameter"</span> &lt;&lt; endl;
00206         }
00207 
00208         <span class="comment">//Handle special case where absolute end of dvs is asked for</span>
00209         <span class="keywordflow">if</span>(time==timeTotal)
00210         {
00211                 <span class="keywordflow">return</span> <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(<a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>()-1).<a class="code" href="structxy__point.html#o1">y</a>;
00212         }
00213 
00214         <span class="comment">//TODO: Make come sort of cached flag that will see if this</span>
00215         <span class="comment">//      actually needs to be performed or not.</span>
00216         <a class="code" href="classDynamicVariableSequence.html#d1">generateTimes</a>(timeTotal);
00217         
00218         <span class="comment">//First, find the segment index that this time/timeTotal refers to</span>
00219         <a class="code" href="Types_8h.html#a2">m_time_type</a> current=0;
00220         <span class="keywordtype">int</span> timeIndex=0;
00221         <span class="keywordflow">while</span>(current&lt;time)
00222         {
00223                 current+=<a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(timeIndex);
00224                 timeIndex++;
00225         }
00226         
00227         <span class="comment">//If we have overshot, lets go back</span>
00228         <span class="keywordflow">if</span>(current!=time)
00229         {
00230                 timeIndex--;
00231                 current-=<a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(timeIndex);
00232         }
00233 
00234         <span class="comment">//Spawn an interpolator of the proper type</span>
00235         <a class="code" href="classInterpolator.html">Interpolator</a> *interp;
00236         <span class="keywordflow">switch</span> (<a class="code" href="classDynamicVariableSequence.html#a22">getSegmentInterpolationType</a>(timeIndex))
00237         {
00238             <span class="keywordflow">case</span> <a class="code" href="Types_8h.html#a13a9">EXPONENTIAL</a>:
00239                 interp=<span class="keyword">new</span> <a class="code" href="classExponentialInterpolator.html">ExponentialInterpolator</a>();
00240                 <span class="keywordflow">break</span>;
00241            
00242             <span class="keywordflow">case</span> <a class="code" href="Types_8h.html#a13a10">CUBIC_SPLINE</a>:
00243                 interp=<span class="keyword">new</span> <a class="code" href="classCubicSplineInterpolator.html">CubicSplineInterpolator</a>();
00244                 <span class="keywordflow">break</span>;
00245 
00246             <span class="keywordflow">default</span>: 
00247                 interp=<span class="keyword">new</span> <a class="code" href="classLinearInterpolator.html">LinearInterpolator</a>();
00248                 <span class="keywordflow">break</span>;
00249         }
00250 
00251         <span class="comment">// set the Interpolator's sampling rate to a fixed granularity</span>
00252         interp-&gt;<a class="code" href="classDynamicVariable.html#a8">setSamplingRate</a>(100);
00253 
00254         <span class="comment">// set interpolator duration to one second to make it easy</span>
00255         interp-&gt;<a class="code" href="classDynamicVariable.html#a6">setDuration</a>(1.0);
00256 
00257         <span class="comment">// We know that this segment interpolates between xy point</span>
00258         <span class="comment">// timeIndex and timeIndex+1</span>
00259         <a class="code" href="structxy__point.html">xy_point</a> left,right;
00260         left=<a class="code" href="classDynamicVariableSequence.html#a15">getPoint</a>(timeIndex);
00261         right=<a class="code" href="classDynamicVariableSequence.html#a15">getPoint</a>(timeIndex+1);
00262 
00263         <span class="comment">// Now tell the interpolator what values we are going between</span>
00264         interp-&gt;<a class="code" href="classInterpolator.html#a2">addEntry</a>(0,left.<a class="code" href="structxy__point.html#o1">y</a>);
00265         interp-&gt;<a class="code" href="classInterpolator.html#a2">addEntry</a>(1,right.<a class="code" href="structxy__point.html#o1">y</a>);
00266 
00267         <span class="comment">// Figure out which sample we want from the interpolator.</span>
00268         <span class="comment">// This is done by taking the percentage we have to iterate thru</span>
00269         <span class="comment">// the interpolator, and then multiplying that by the number of samples</span>
00270         <span class="keywordtype">int</span> sample=int(round(((time-current)/<a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(timeIndex))*100.0));
00271 
00272         <span class="comment">// Create a value iterator to get values from the interpolator</span>
00273         <a class="code" href="classIterator.html">Iterator&lt;m_value_type&gt;</a> tempIterator=interp-&gt;<a class="code" href="classInterpolator.html#a3">valueIterator</a>();
00274 
00275         <span class="comment">// Now lets skip the first sample-1 samples...</span>
00276         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i=0;i&lt;sample;i++)
00277         {
00278                 tempIterator.<a class="code" href="classIterator.html#a5">next</a>();
00279         }
00280 
00281         <span class="comment">// Now grab the one we want</span>
00282         <a class="code" href="Types_8h.html#a3">m_value_type</a> returnval=tempIterator.<a class="code" href="classIterator.html#a5">next</a>();
00283 
00284         <span class="keyword">delete</span> interp;
00285 
00286         <span class="keywordflow">return</span> returnval;
00287 }
00288 
00289 
00290 <span class="comment">/* //The old getValue</span>
00291 <span class="comment">m_value_type DynamicVariableSequence::getValue (m_time_type time,</span>
00292 <span class="comment">                                                m_time_type timeTotal)</span>
00293 <span class="comment">{</span>
00294 <span class="comment">    m_rate_type newSamplingRate = 50;</span>
00295 <span class="comment">    m_rate_type oldSamplingRate = this-&gt;getSamplingRate();</span>
00296 <span class="comment">    m_time_type oldDuration = this-&gt;getDuration();</span>
00297 <span class="comment">    m_value_type returnValue = 0;</span>
00298 <span class="comment"></span>
00299 <span class="comment">    if (time &gt; timeTotal || time &lt; 0)</span>
00300 <span class="comment">    {</span>
00301 <span class="comment">        // they are dumb for passing in invalid values, so let them know</span>
00302 <span class="comment">        cout &lt;&lt; "DVS::getValue(...): invalid time or totalTime parameter" &lt;&lt; endl;</span>
00303 <span class="comment">    }</span>
00304 <span class="comment">    else</span>
00305 <span class="comment">    {</span>
00306 <span class="comment">        // set the dynamic variable parameters to temporary values</span>
00307 <span class="comment">        this-&gt;setSamplingRate(newSamplingRate);</span>
00308 <span class="comment">        this-&gt;setDuration(timeTotal);</span>
00309 <span class="comment"></span>
00310 <span class="comment">        // get an iterator for this shape</span>
00311 <span class="comment">        Iterator&lt;m_value_type&gt; *tempIterator =</span>
00312 <span class="comment">            new Iterator&lt;m_value_type&gt; (valueIterator());</span>
00313 <span class="comment"></span>
00314 <span class="comment">        // we can calculate how many samples are needed for the floor (time)</span>
00315 <span class="comment">        m_time_type timeSum = (m_time_type) floor ((double) time);</span>
00316 <span class="comment">        int iNumGetValCalls = newSamplingRate * ((int) floor (time));</span>
00317 <span class="comment"></span>
00318 <span class="comment">        // now, calculate how many samples are needed for (time - floor (time))</span>
00319 <span class="comment">        while (timeSum &lt; time)</span>
00320 <span class="comment">        {</span>
00321 <span class="comment">            timeSum = timeSum + (1.0 / newSamplingRate);    </span>
00322 <span class="comment">            iNumGetValCalls++;</span>
00323 <span class="comment">        }</span>
00324 <span class="comment"></span>
00325 <span class="comment">        // it seems to be a few samples off...this is a hack to get good values</span>
00326 <span class="comment">        iNumGetValCalls += 2;</span>
00327 <span class="comment"></span>
00328 <span class="comment">        // iterate, based on the values calculated</span>
00329 <span class="comment">        for (int iLoop = 0; iLoop &lt; iNumGetValCalls; iLoop++)</span>
00330 <span class="comment">        {</span>
00331 <span class="comment">            returnValue = tempIterator-&gt;next();</span>
00332 <span class="comment">        }</span>
00333 <span class="comment"></span>
00334 <span class="comment">        // cout &lt;&lt; "  iNumGetValCalls = " &lt;&lt; iNumGetValCalls &lt;&lt; endl;</span>
00335 <span class="comment">        // cout &lt;&lt; "  timeSum = " &lt;&lt; timeSum &lt;&lt; endl;</span>
00336 <span class="comment"></span>
00337 <span class="comment">        // set the dynamic variable paramaters back to what they were</span>
00338 <span class="comment">        this-&gt;setSamplingRate(oldSamplingRate);</span>
00339 <span class="comment">        this-&gt;setDuration(oldDuration);</span>
00340 <span class="comment">    }</span>
00341 <span class="comment"></span>
00342 <span class="comment">    return (returnValue);</span>
00343 <span class="comment"></span>
00344 <span class="comment">}</span>
00345 <span class="comment">*/</span>
00346 
00347 <span class="comment">//----------------------------------------------------------------------------//</span>
00348 <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a7">DynamicVariableSequence::DefineShape</a>
<a name="l00349"></a><a class="code" href="classDynamicVariableSequence.html#a7">00349</a>     (<a class="code" href="classCollection.html">Collection&lt;xy_point&gt;</a> xyPoints,
00350      <a class="code" href="classCollection.html">Collection&lt;envelope_segment&gt;</a> segments)
00351 {
00352     <span class="comment">// make sure we don't cause a memory leak</span>
00353     <span class="keywordflow">if</span> (xyPoints_ != NULL)
00354     {
00355         <span class="keyword">delete</span> (xyPoints_);
00356     }
00357     <span class="keywordflow">if</span> (segments_ != NULL)
00358     {
00359         <span class="keyword">delete</span> (segments_);
00360     }
00361 
00362     <span class="keywordflow">if</span> (xyPoints.size ( ) != (segments.size ( ) + 1) )
00363       {
00364         cout &lt;&lt; <span class="stringliteral">"WARNING: Invalid Collection sizes for points or segments"</span> &lt;&lt; endl;
00365         cout &lt;&lt; <span class="stringliteral">"points.size ( ) should be segments.size ( ) + 1"</span> &lt;&lt; endl;
00366       }
00367 
00368     <span class="comment">// set our local variables to copies of the variables passed in</span>
00369     xyPoints_ = <span class="keyword">new</span> <a class="code" href="classCollection.html">Collection&lt;xy_point&gt;</a> (xyPoints);
00370     segments_ = <span class="keyword">new</span> <a class="code" href="classCollection.html">Collection&lt;envelope_segment&gt;</a> (segments);
00371 }
00372 
00373 <span class="comment">//----------------------------------------------------------------------------//</span>
00374 <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a8">DynamicVariableSequence::AddToShape</a>
<a name="l00375"></a><a class="code" href="classDynamicVariableSequence.html#a8">00375</a> (<a class="code" href="classCollection.html">Collection&lt;xy_point&gt;</a> xyPoints,
00376  <a class="code" href="classCollection.html">Collection&lt;envelope_segment&gt;</a> segments)
00377 {
00378   <span class="comment">// case: Adding to an empty Collection</span>
00379   <span class="keywordflow">if</span> ( (xyPoints_ == NULL) || (segments_ == NULL) )
00380     {
00381       xyPoints_ = <span class="keyword">new</span> Collection &lt;xy_point&gt; (xyPoints);
00382       segments_ = <span class="keyword">new</span> Collection &lt;envelope_segment&gt; (segments);
00383       <span class="keywordflow">return</span>;
00384     }
00385 
00386   <span class="keywordtype">int</span> iNumSegments = segments.size();
00387   <a class="code" href="Types_8h.html#a2">m_time_type</a> timeOffset = xyPoints_-&gt;get(xyPoints_-&gt;size() - 1).x;
00388   <a class="code" href="structxy__point.html">xy_point</a> pointTemp;
00389 
00390   <span class="comment">// verify that the last old point and the first new point have the</span>
00391   <span class="comment">// same y value (usually zero), that they can be appended</span>
00392   <span class="keywordflow">if</span> ( (xyPoints_ -&gt; get (xyPoints_ -&gt; size ( ) -1).y)
00393        != (xyPoints.get (0).y ) )
00394     {
00395       cout &lt;&lt; <span class="stringliteral">"WARNING: Y values of last point of first envelope\n"</span>;
00396       cout &lt;&lt; <span class="stringliteral">"and first point of second envelope do not match.\n"</span>;
00397       cout &lt;&lt; <span class="stringliteral">"This implementation corrupts the first point of the\n"</span>;
00398       cout &lt;&lt; <span class="stringliteral">"second envelope\n"</span>;
00399     }
00400 
00401   <span class="comment">// for every element in the new collections</span>
00402   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumSegments; iIndex++)
00403     {
00404       <span class="comment">// add the current segment and point + 1 to our existing Collections</span>
00405       pointTemp = xyPoints.get(iIndex + 1);
00406       pointTemp.<a class="code" href="structxy__point.html#o0">x</a> = pointTemp.<a class="code" href="structxy__point.html#o0">x</a> + timeOffset;
00407       xyPoints_-&gt;add(pointTemp);
00408       segments_-&gt;add(segments.get(iIndex));
00409     }
00410 }
00411 
00412 <span class="comment">//----------------------------------------------------------------------------//</span>
00413 <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a8">DynamicVariableSequence::AddToShape</a>
<a name="l00414"></a><a class="code" href="classDynamicVariableSequence.html#a9">00414</a>     (<a class="code" href="classDynamicVariableSequence.html">DynamicVariableSequence</a> * shape)
00415 {
00416   <span class="keywordflow">if</span> ( (shape -&gt; xyPoints_ == NULL) || (shape -&gt; segments_ == NULL) )
00417     {
00418       cout &lt;&lt; <span class="stringliteral">"ERROR: DVS to be added is undefined.\n"</span>;
00419       <span class="keywordflow">return</span>;
00420     }
00421 
00422     AddToShape ( * (shape -&gt; xyPoints_), * (shape -&gt; segments_) );
00423 }
00424 
00425 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00426"></a><a class="code" href="classDynamicVariableSequence.html#a10">00426</a> <a class="code" href="classCollection.html">Collection&lt;xy_point&gt;</a>* <a class="code" href="classDynamicVariableSequence.html#a10">DynamicVariableSequence::getPoints</a> ()
00427 {
00428     <span class="comment">// the point data are stored in a member variable, so return a copy of it</span>
00429     <span class="keywordflow">return</span> (<span class="keyword">new</span> <a class="code" href="classCollection.html">Collection&lt;xy_point&gt;</a> (*xyPoints_));
00430 }
00431 
00432 
00433 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00434"></a><a class="code" href="classDynamicVariableSequence.html#a11">00434</a> <a class="code" href="classCollection.html">Collection&lt;envelope_segment&gt;</a>* <a class="code" href="classDynamicVariableSequence.html#a11">DynamicVariableSequence::getSegments</a> ()
00435 {
00436     <span class="comment">// the point data are stored in a member variable, so return a copy of it</span>
00437     <span class="keywordflow">return</span> (<span class="keyword">new</span> <a class="code" href="classCollection.html">Collection&lt;envelope_segment&gt;</a> (*segments_));
00438 }
00439 
00440 
00441 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00442"></a><a class="code" href="classDynamicVariableSequence.html#a12">00442</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a12">DynamicVariableSequence::setSegment</a> (<span class="keywordtype">int</span> index, <a class="code" href="structenvelope__segment.html">envelope_segment</a> segment)
00443 {
00444     <span class="comment">// lets the Collection class hand an invalid index</span>
00445     <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a>(index, segment);
00446 }
00447 
00448 
00449 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00450"></a><a class="code" href="classDynamicVariableSequence.html#a13">00450</a> <a class="code" href="structenvelope__segment.html">envelope_segment</a> <a class="code" href="classDynamicVariableSequence.html#a13">DynamicVariableSequence::getSegment</a> (<span class="keywordtype">int</span> index)
00451 {
00452     <span class="comment">// lets the Collection class hand an invalid index</span>
00453     <span class="keywordflow">return</span> <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(index);
00454 }
00455 
00456 
00457 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00458"></a><a class="code" href="classDynamicVariableSequence.html#a14">00458</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a14">DynamicVariableSequence::setPoint</a> (<span class="keywordtype">int</span> index, <a class="code" href="structxy__point.html">xy_point</a> point)
00459 {
00460     <span class="comment">// lets the Collection class hand an invalid index</span>
00461     <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a>(index, point);
00462 }
00463 
00464 
00465 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00466"></a><a class="code" href="classDynamicVariableSequence.html#a15">00466</a> <a class="code" href="structxy__point.html">xy_point</a> <a class="code" href="classDynamicVariableSequence.html#a15">DynamicVariableSequence::getPoint</a> (<span class="keywordtype">int</span> index)
00467 {
00468     <span class="comment">// lets the Collection class hand an invalid index</span>
00469     <span class="keywordflow">return</span> <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(index);
00470 }
00471 
00472 
00473 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00474"></a><a class="code" href="classDynamicVariableSequence.html#a16">00474</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a16">DynamicVariableSequence::addPoint</a> (<a class="code" href="structxy__point.html">xy_point</a> point)
00475 {
00476     <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a4">add</a>(point);
00477 }
00478 
00479 
00480 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00481"></a><a class="code" href="classDynamicVariableSequence.html#a17">00481</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a17">DynamicVariableSequence::addSegment</a> (<a class="code" href="structenvelope__segment.html">envelope_segment</a> segment)
00482 {
00483     <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a4">add</a>(segment);
00484 }
00485 
00486 
00487 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00488"></a><a class="code" href="classDynamicVariableSequence.html#a18">00488</a> <a class="code" href="Types_8h.html#a2">m_time_type</a> <a class="code" href="classDynamicVariableSequence.html#a18">DynamicVariableSequence::getSegmentTime</a> (<span class="keywordtype">int</span> index)
00489 {
00490     <span class="comment">// lets the Collection class hand an invalid index</span>
00491     <span class="keywordflow">return</span> (<a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(index).<a class="code" href="structenvelope__segment.html#o2">timeValue</a>);
00492 }
00493 
00494 
00495 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00496"></a><a class="code" href="classDynamicVariableSequence.html#a19">00496</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a19">DynamicVariableSequence::setSegmentTime</a> (<span class="keywordtype">int</span> index, <a class="code" href="Types_8h.html#a2">m_time_type</a> time)
00497 {
00498     <span class="comment">// make sure the time is positive, otherwise bad things will happen</span>
00499     <span class="keywordflow">if</span> (time &lt; 0)
00500     {
00501         time = -time;
00502     }
00503 
00504     <span class="comment">// assumes a valid index is supplied</span>
00505     <a class="code" href="structenvelope__segment.html">envelope_segment</a> segTemp = <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a> (index);
00506     segTemp.<a class="code" href="structenvelope__segment.html#o2">timeValue</a> = time;
00507     <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a> (index, segTemp);
00508 }
00509 
00510 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00511"></a><a class="code" href="classDynamicVariableSequence.html#a20">00511</a> <a class="code" href="Types_8h.html#a12">stretch_type</a> <a class="code" href="classDynamicVariableSequence.html#a20">DynamicVariableSequence::getSegmentTimeType</a> (<span class="keywordtype">int</span> index)
00512 {
00513     <span class="comment">// assumes a valid index is supplied</span>
00514     <span class="keywordflow">return</span> (<a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(index).<a class="code" href="structenvelope__segment.html#o1">timeType</a>);
00515 }
00516 
00517 
00518 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00519"></a><a class="code" href="classDynamicVariableSequence.html#a21">00519</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a21">DynamicVariableSequence::setSegmentTimeType</a> (<span class="keywordtype">int</span> index,
00520                                                   stretch_type timeType)
00521 {
00522     <span class="comment">// assumes a valid index is supplied</span>
00523     <a class="code" href="structenvelope__segment.html">envelope_segment</a> segTemp = <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a> (index);
00524     segTemp.<a class="code" href="structenvelope__segment.html#o1">timeType</a> = timeType;
00525     <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a> (index, segTemp);
00526 }
00527 
00528 
00529 <span class="comment">//----------------------------------------------------------------------------//</span>
00530 <a class="code" href="Types_8h.html#a13">interpolation_type</a> <a class="code" href="classDynamicVariableSequence.html#a22">DynamicVariableSequence::getSegmentInterpolationType</a>
<a name="l00531"></a><a class="code" href="classDynamicVariableSequence.html#a22">00531</a>                                             (<span class="keywordtype">int</span> index)
00532 {
00533     <span class="comment">// assumes a valid index is supplied</span>
00534     <span class="keywordflow">return</span> (segments_-&gt;get(index).interType);
00535 }
00536 
00537 
00538 <span class="comment">//----------------------------------------------------------------------------//</span>
00539 <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a23">DynamicVariableSequence::setSegmentInterpolationType</a>
<a name="l00540"></a><a class="code" href="classDynamicVariableSequence.html#a23">00540</a>                               (<span class="keywordtype">int</span> index,
00541                                <a class="code" href="Types_8h.html#a13">interpolation_type</a> interType)
00542 {
00543     <span class="comment">// assumes a valid index is supplied</span>
00544     <a class="code" href="structenvelope__segment.html">envelope_segment</a> segTemp = segments_-&gt;get (index);
00545     segTemp.<a class="code" href="structenvelope__segment.html#o0">interType</a> = interType;
00546     segments_-&gt;set (index, segTemp);
00547 }
00548 
00549 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00550"></a><a class="code" href="classDynamicVariableSequence.html#d2">00550</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classDynamicVariableSequence.html#d2">DynamicVariableSequence::checkValidSegmentIndex</a> (<span class="keywordtype">int</span> index)
00551 {
00552     <span class="comment">// check if index is valid</span>
00553     <span class="keywordflow">return</span> ((index &gt;= 0) &amp;&amp; (<a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>() &gt; index));
00554 }
00555 
00556     
00557 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00558"></a><a class="code" href="classDynamicVariableSequence.html#d3">00558</a> <span class="keyword">inline</span> <span class="keywordtype">bool</span> <a class="code" href="classDynamicVariableSequence.html#d3">DynamicVariableSequence::checkValidPointIndex</a> (<span class="keywordtype">int</span> index)
00559 {
00560     <span class="comment">// check if index is valid</span>
00561     <span class="keywordflow">return</span> ((index &gt;= 0) &amp;&amp; (<a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>() &gt; index));
00562 }
00563 
00564 
00565 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00566"></a><a class="code" href="classDynamicVariableSequence.html#a24">00566</a> <a class="code" href="classIterator.html">Iterator&lt;m_value_type&gt;</a> <a class="code" href="classDynamicVariableSequence.html#a24">DynamicVariableSequence::valueIterator</a>()
00567 {
00568     <span class="comment">// optimize so that if the envelope is used repeatedly without changing</span>
00569     <span class="comment">// the time value that is assigned, interpolators are not re-created</span>
00570     <span class="comment">// every time</span>
00571     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> != this-&gt;<a class="code" href="classDynamicVariable.html#a7">getDuration</a>()
00572         || <a class="code" href="classDynamicVariableSequence.html#r5">currentInterpolatorRate_</a> != this-&gt;<a class="code" href="classDynamicVariable.html#a9">getSamplingRate</a>())
00573     {
00574         <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> = this-&gt;<a class="code" href="classDynamicVariable.html#a7">getDuration</a>();
00575         <a class="code" href="classDynamicVariableSequence.html#r5">currentInterpolatorRate_</a> = this-&gt;<a class="code" href="classDynamicVariable.html#a9">getSamplingRate</a>();
00576 
00577         <span class="comment">// populate the times member variable with times</span>
00578         <a class="code" href="classDynamicVariableSequence.html#d1">generateTimes</a>(<a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a>);
00579 
00580         <span class="comment">// populate the interpolator member variable with interpolators, based</span>
00581         <span class="comment">// on the times just set</span>
00582         <a class="code" href="classDynamicVariableSequence.html#d0">addInterpolators</a>(<a class="code" href="classDynamicVariableSequence.html#r5">currentInterpolatorRate_</a>);
00583     }
00584 
00585     <span class="comment">// give them the big iterator</span>
00586     <span class="keywordflow">return</span> (<a class="code" href="classIterator.html">Iterator&lt;m_value_type&gt;</a>
00587                 (<span class="keyword">new</span> <a class="code" href="classDynamicVariableSequenceIterator.html">DynamicVariableSequenceIterator</a>(*<a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>)));
00588 }
00589 
00590 
00591 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00592"></a><a class="code" href="classDynamicVariableSequence.html#d1">00592</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#d1">DynamicVariableSequence::generateTimes</a> (<a class="code" href="Types_8h.html#a2">m_time_type</a> totalTime)
00593 {
00594 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00595 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"DVS::generateTimes"</span> &lt;&lt; endl;
00596 <span class="preprocessor">#endif</span>
00597 <span class="preprocessor"></span>    <span class="keywordtype">int</span> iNumSegments = <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>();
00598     <span class="keywordtype">double</span> dTotalFixedTime = 0;
00599     <span class="keywordtype">double</span> dTotalFlexPercent = 0;
00600     <span class="keywordtype">double</span> dScaleRatio = 1;
00601 
00602     <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> = totalTime;
00603 
00604     <span class="comment">// get rid of previously generated times and make a new collection</span>
00605     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a> != NULL)
00606     {
00607         <span class="keyword">delete</span> (<a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>);
00608     }
00609     <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a> = <span class="keyword">new</span> <a class="code" href="classCollection.html">Collection&lt;m_time_type&gt;</a> ();
00610 
00611     <span class="comment">// figure out how they want to allocate time for each segment and populate</span>
00612     <span class="comment">// the generated times with their current values</span>
00613     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumSegments; iIndex++)
00614     {
00615         <span class="comment">// if this segment has fixed-time, increment fixed time running total</span>
00616         <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classDynamicVariableSequence.html#a20">getSegmentTimeType</a>(iIndex) == <a class="code" href="Types_8h.html#a12a7">FIXED</a>)
00617         {
00618             dTotalFixedTime += this-&gt;<a class="code" href="classDynamicVariableSequence.html#a18">getSegmentTime</a>(iIndex);
00619         }
00620         <span class="comment">// else increment flex-time running total</span>
00621         <span class="keywordflow">else</span>
00622         {
00623             dTotalFlexPercent += this-&gt;<a class="code" href="classDynamicVariableSequence.html#a18">getSegmentTime</a>(iIndex);
00624         }
00625         <span class="comment">// append their current value to our values for generated times</span>
00626         <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a4">add</a>(this-&gt;getSegmentTime(iIndex));
00627     }
00628 
00629     <span class="comment">// now, correct the generated values as necessary (i.e. the rest of this)</span>
00630 
00631     <span class="comment">// if they specified more FIXED time than actual time, or if there is no</span>
00632     <span class="comment">// FIEXIBLE time and they did not specify enough FIXED time, scale the</span>
00633     <span class="comment">// FIXED times to the actual time (and set total amount of FLEXIBLE time</span>
00634     <span class="comment">// to zero)</span>
00635     <span class="keywordflow">if</span> (dTotalFixedTime &gt; <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a>
00636         || (dTotalFixedTime &lt; <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> &amp;&amp; dTotalFlexPercent == 0))
00637     {
00638         <span class="comment">// no flexible time is available</span>
00639         dTotalFlexPercent = 0;
00640 
00641         <span class="comment">// get a ratio to scale all fixed time entries by</span>
00642         dScaleRatio = <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> / dTotalFixedTime;
00643 
00644 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00645 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"DVS::generateTimes FIXED dScaleRatio = "</span> &lt;&lt; dScaleRatio &lt;&lt; endl;
00646 <span class="preprocessor">#endif</span>
00647 <span class="preprocessor"></span>
00648         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumSegments; iIndex++)
00649         {
00650             <span class="comment">// scale every FIXED time value</span>
00651             <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classDynamicVariableSequence.html#a20">getSegmentTimeType</a>(iIndex) == <a class="code" href="Types_8h.html#a12a7">FIXED</a>)
00652             {
00653                 <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a>
00654                     (iIndex,
00655                      this-&gt;<a class="code" href="classDynamicVariableSequence.html#a18">getSegmentTime</a>(iIndex) * dScaleRatio);
00656             }
00657             <span class="keywordflow">else</span>
00658             {
00659                 <span class="comment">// all flex time entries are set to 0</span>
00660                 <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a> (iIndex, 0);
00661             }
00662         }
00663     }
00664     <span class="comment">// else if their percentages do not add up to 100% (i.e. 1.0) and they are</span>
00665     <span class="comment">// trying to use flex time, scale the flex time values</span>
00666     <span class="keywordflow">else</span> <span class="keywordflow">if</span> (dTotalFlexPercent != 1.0 &amp;&amp; dTotalFlexPercent != 0)
00667     {
00668         dScaleRatio = 1.0 / dTotalFlexPercent;
00669 
00670 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00671 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"DVS::generateTimes FLEXIBLE dScaleRatio = "</span> &lt;&lt; dScaleRatio &lt;&lt; endl;
00672 <span class="preprocessor">#endif</span>
00673 <span class="preprocessor"></span>
00674         <span class="comment">// scale percentages</span>
00675         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumSegments; iIndex++)
00676         {
00677             <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classDynamicVariableSequence.html#a20">getSegmentTimeType</a>(iIndex) == <a class="code" href="Types_8h.html#a12a8">FLEXIBLE</a>)
00678             {
00679                 <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a>
00680                     (iIndex,
00681                      this-&gt;<a class="code" href="classDynamicVariableSequence.html#a18">getSegmentTime</a>(iIndex) * dScaleRatio);
00682             }
00683         }
00684     }
00685 
00686     <span class="comment">// if we have FLEXIBLE time to set, the values stored right now are only</span>
00687     <span class="comment">// ratios of time available, so we need to set them to actual times</span>
00688     <span class="keywordflow">if</span> (dTotalFlexPercent &gt; 0)
00689     {
00690         <span class="comment">// calculate the time available to use for flex durations</span>
00691         <span class="keywordtype">double</span> flexTimeAvailable = <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> - dTotalFixedTime;
00692 
00693 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00694 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"DVS::generateTimes flexTimeAvailable = "</span> &lt;&lt; flexTimeAvailable &lt;&lt; endl;
00695 <span class="preprocessor">#endif</span>
00696 <span class="preprocessor"></span>
00697         <span class="comment">// set actual durations for FLEXIBLE time segments</span>
00698         <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumSegments; iIndex++)
00699         {
00700             <span class="comment">// if this is a flex-time entry, set time accordingly</span>
00701             <span class="keywordflow">if</span> (this-&gt;<a class="code" href="classDynamicVariableSequence.html#a20">getSegmentTimeType</a>(iIndex) == <a class="code" href="Types_8h.html#a12a8">FLEXIBLE</a>)
00702             {
00703                 <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a>
00704                     (iIndex,
00705                      <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex) * flexTimeAvailable);
00706             }
00707         }
00708     }
00709 
00710 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00711 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"DVS::generateTimes all done.  Segments times are:"</span> &lt;&lt; endl;
00712 
00713     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumSegments; iIndex++)
00714     {
00715         cout &lt;&lt; <span class="stringliteral">"Segment "</span> &lt;&lt; iIndex &lt;&lt; <span class="stringliteral">": "</span> &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex) &lt;&lt; endl;
00716     }
00717 <span class="preprocessor">#endif</span>
00718 <span class="preprocessor"></span>}
00719 
00720 
00721 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00722"></a><a class="code" href="classDynamicVariableSequence.html#d0">00722</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#d0">DynamicVariableSequence::addInterpolators</a> (<a class="code" href="Types_8h.html#a4">m_rate_type</a> rate)
00723 {
00724 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00725 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"DVS::addInterpolators"</span> &lt;&lt; endl;
00726     cout &lt;&lt; <span class="stringliteral">"num segments: "</span> &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>() &lt;&lt; endl;
00727     cout &lt;&lt; <span class="stringliteral">"num points: "</span> &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>() &lt;&lt; endl;
00728 <span class="preprocessor">#endif</span>
00729 <span class="preprocessor"></span>
00730     <span class="keywordtype">int</span> iNumSegments = <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>();
00731 
00732     <span class="comment">// clear out interpolators that are stored, if there are any stored</span>
00733     <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a> != NULL)
00734     {
00735         <span class="keyword">delete</span> (<a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>);
00736     }
00737 
00738     <span class="comment">// initialize a new Collection for interpolators</span>
00739     <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a> = <span class="keyword">new</span> <a class="code" href="classCollection.html">Collection&lt;Interpolator*&gt;</a> ();
00740 
00741     <span class="comment">// for each segment that we have, store a new interpolator</span>
00742     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumSegments; iIndex++)
00743     {
00744         <span class="comment">// add an interpolator for the current segment to the Collection</span>
00745         <span class="keywordflow">switch</span> (<a class="code" href="classDynamicVariableSequence.html#a22">getSegmentInterpolationType</a>(iIndex))
00746         {
00747             <span class="keywordflow">case</span> <a class="code" href="Types_8h.html#a13a9">EXPONENTIAL</a>:
00748                 <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a4">add</a>(<span class="keyword">new</span> <a class="code" href="classExponentialInterpolator.html">ExponentialInterpolator</a>());
00749                 <span class="keywordflow">break</span>;
00750            
00751             <span class="keywordflow">case</span> <a class="code" href="Types_8h.html#a13a10">CUBIC_SPLINE</a>:
00752                 <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a4">add</a>(<span class="keyword">new</span> <a class="code" href="classCubicSplineInterpolator.html">CubicSplineInterpolator</a>());
00753                 <span class="keywordflow">break</span>;
00754 
00755             <span class="keywordflow">default</span>: 
00756                 <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a4">add</a>(<span class="keyword">new</span> <a class="code" href="classLinearInterpolator.html">LinearInterpolator</a>());
00757                 <span class="keywordflow">break</span>;
00758         }
00759 
00760         <span class="comment">// set the Interpolator's sampling rate to the rate specified</span>
00761         <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex)-&gt;<a class="code" href="classDynamicVariable.html#a8">setSamplingRate</a>(rate);
00762 
00763         <a class="code" href="Types_8h.html#a2">m_time_type</a> tempTimeValue = <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex);
00764 
00765         <span class="comment">// add a start and end point to this interpolator:</span>
00766         <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex)-&gt;<a class="code" href="classInterpolator.html#a2">addEntry</a>(0, <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex).<a class="code" href="structxy__point.html#o1">y</a>);
00767         <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex)-&gt;<a class="code" href="classInterpolator.html#a2">addEntry</a>
00768             (tempTimeValue,
00769              <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex + 1).<a class="code" href="structxy__point.html#o1">y</a>);
00770 
00771         <span class="comment">// set interpolator duration</span>
00772         <a class="code" href="classDynamicVariableSequence.html#r2">interpolators_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex)-&gt;<a class="code" href="classDynamicVariable.html#a6">setDuration</a>(tempTimeValue);
00773 
00774 <span class="preprocessor">#ifdef DEBUG_MODE</span>
00775 <span class="preprocessor"></span>    cout &lt;&lt; <span class="stringliteral">"Interpolator #"</span> &lt;&lt; iIndex &lt;&lt; <span class="stringliteral">" - added points: "</span> &lt;&lt; endl;
00776     cout &lt;&lt; <span class="stringliteral">"   (0, "</span> &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex).<a class="code" href="structxy__point.html#o1">y</a> &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
00777     cout &lt;&lt; <span class="stringliteral">"   ("</span> &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r3">generatedSegmentTimes_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex) &lt;&lt; <span class="stringliteral">", "</span>;
00778     cout &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex + 1).<a class="code" href="structxy__point.html#o1">y</a> &lt;&lt; <span class="stringliteral">")"</span> &lt;&lt; endl;
00779 <span class="preprocessor">#endif</span>
00780 <span class="preprocessor"></span>    }
00781 }
00782 
00783 
00784 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00785"></a><a class="code" href="classDynamicVariableSequence.html#a25">00785</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a25">DynamicVariableSequence::scale</a>(<a class="code" href="Types_8h.html#a3">m_value_type</a> factor)
00786 {
00787     <span class="keywordtype">int</span> iNumPoints = <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>();
00788     <a class="code" href="structxy__point.html">xy_point</a> pointTemp;
00789 
00790     <span class="comment">// for every point that we've got stored</span>
00791     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumPoints; iIndex++)
00792     {
00793         <span class="comment">// scale this value by the factor given</span>
00794         pointTemp.<a class="code" href="structxy__point.html#o0">x</a> = <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex).<a class="code" href="structxy__point.html#o0">x</a>;
00795         pointTemp.<a class="code" href="structxy__point.html#o1">y</a> = (<a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex).<a class="code" href="structxy__point.html#o1">y</a>) * factor;
00796         <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a9">set</a>(iIndex, pointTemp);
00797     }
00798 }
00799     
00800      
00801 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00802"></a><a class="code" href="classDynamicVariableSequence.html#a26">00802</a> <a class="code" href="Types_8h.html#a3">m_value_type</a> <a class="code" href="classDynamicVariableSequence.html#a26">DynamicVariableSequence::getMaxValue</a>()
00803 {
00804     <span class="keywordtype">int</span> iNumPoints = <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a10">size</a>();
00805     <a class="code" href="Types_8h.html#a3">m_value_type</a> maxVal = 0.0;
00806 
00807     <span class="comment">// for every point that we've got stored</span>
00808     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iIndex = 0; iIndex &lt; iNumPoints; iIndex++)
00809     {
00810         <span class="comment">// if this point's value is greater than the max, set max = this value</span>
00811         <span class="keywordflow">if</span> (<a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex).<a class="code" href="structxy__point.html#o1">y</a> &gt; maxVal)
00812         {
00813             maxVal = <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a7">get</a>(iIndex).<a class="code" href="structxy__point.html#o1">y</a>;
00814         }
00815     }
00816 
00817     <span class="keywordflow">return</span> maxVal;
00818 }
00819 
00820 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00821"></a><a class="code" href="classDynamicVariableSequence.html#a28">00821</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a27">DynamicVariableSequence::xml_print</a>( ofstream&amp; xmlOutput )
00822 {
00823         <a class="code" href="classDynamicVariable.html">DynamicVariable</a>* pnt2dyn = <span class="keyword">this</span>;
00824 
00825         xmlOutput &lt;&lt; <span class="stringliteral">"&lt;dv id=\""</span> &lt;&lt; (<span class="keywordtype">long</span>)pnt2dyn &lt;&lt; <span class="stringliteral">"\"&gt;"</span> &lt;&lt; endl;
00826         xmlOutput &lt;&lt; <span class="stringliteral">"\t&lt;dv_type value=\"dvs\" /&gt;"</span> &lt;&lt; endl;
00827         xmlOutput &lt;&lt; <span class="stringliteral">"\t&lt;duration value=\""</span> &lt;&lt; <a class="code" href="classDynamicVariable.html#a7">getDuration</a>() &lt;&lt; <span class="stringliteral">"\" /&gt;"</span> &lt;&lt; endl;
00828         xmlOutput &lt;&lt; <span class="stringliteral">"\t&lt;rate value=\""</span> &lt;&lt; <a class="code" href="classDynamicVariable.html#a9">getSamplingRate</a>() &lt;&lt; <span class="stringliteral">"\" /&gt;"</span> &lt;&lt; endl;
00829 
00830         <span class="comment">//Print out private vars and collections for DVS here</span>
00831         xmlOutput &lt;&lt; <span class="stringliteral">"\t&lt;totalTime value=\""</span> &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r4">totalTime_</a> &lt;&lt; <span class="stringliteral">"\" /&gt;"</span> &lt;&lt; endl;
00832         xmlOutput &lt;&lt; <span class="stringliteral">"\t&lt;currentInterpolatorRate value=\""</span> &lt;&lt; <a class="code" href="classDynamicVariableSequence.html#r5">currentInterpolatorRate_</a> &lt;&lt; <span class="stringliteral">"\" /&gt;"</span> &lt;&lt; endl;
00833         <a class="code" href="structxy__point.html">xy_point</a> mypoint;
00834         <a class="code" href="classIterator.html">Iterator&lt;xy_point&gt;</a> it_points = <a class="code" href="classDynamicVariableSequence.html#r0">xyPoints_</a>-&gt;<a class="code" href="classCollection.html#a12">iterator</a>();
00835         <span class="keywordflow">while</span>( it_points.<a class="code" href="classIterator.html#a4">hasNext</a>() )
00836         {
00837                 mypoint = it_points.<a class="code" href="classIterator.html#a5">next</a>();
00838                 xmlOutput &lt;&lt; <span class="stringliteral">"\t&lt;xyPoints x=\""</span> &lt;&lt; mypoint.<a class="code" href="structxy__point.html#o0">x</a> &lt;&lt; <span class="stringliteral">"\" "</span>;
00839                 xmlOutput &lt;&lt; <span class="stringliteral">"value=\""</span> &lt;&lt; mypoint.<a class="code" href="structxy__point.html#o1">y</a> &lt;&lt; <span class="stringliteral">"\" /&gt;"</span> &lt;&lt; endl;
00840         }
00841         <a class="code" href="structenvelope__segment.html">envelope_segment</a> myseg;
00842         <a class="code" href="classIterator.html">Iterator&lt;envelope_segment&gt;</a> it_segments = <a class="code" href="classDynamicVariableSequence.html#r1">segments_</a>-&gt;<a class="code" href="classCollection.html#a12">iterator</a>();
00843         <span class="keywordflow">while</span>(it_segments.<a class="code" href="classIterator.html#a4">hasNext</a>())
00844         {
00845                 myseg = it_segments.<a class="code" href="classIterator.html#a5">next</a>();
00846                 xmlOutput &lt;&lt; <span class="stringliteral">"\t&lt;segments interType=\""</span> &lt;&lt; myseg.<a class="code" href="structenvelope__segment.html#o0">interType</a> &lt;&lt; <span class="stringliteral">"\" "</span>;
00847                 xmlOutput &lt;&lt; <span class="stringliteral">"timeType=\""</span> &lt;&lt; myseg.<a class="code" href="structenvelope__segment.html#o1">timeType</a> &lt;&lt; <span class="stringliteral">"\" "</span>;
00848                 xmlOutput &lt;&lt; <span class="stringliteral">"timeValue=\""</span> &lt;&lt; myseg.<a class="code" href="structenvelope__segment.html#o2">timeValue</a> &lt;&lt; <span class="stringliteral">"\" /&gt;"</span> &lt;&lt; endl;
00849         }
00850         <span class="comment">//Note: the interpolators_ and generatedSegmentTimes_ collections</span>
00851         <span class="comment">//      doesn't need to be backed up; it is used for internal</span>
00852         <span class="comment">//      optimization only, not storing data</span>
00853 
00854         xmlOutput &lt;&lt; <span class="stringliteral">"&lt;/dv&gt;"</span> &lt;&lt; endl;
00855 }
00856 
00857 <span class="comment">//----------------------------------------------------------------------------//</span>
<a name="l00858"></a><a class="code" href="classDynamicVariableSequence.html#a27">00858</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a27">DynamicVariableSequence::xml_print</a>( ofstream&amp; xmlOutput, list&lt;DynamicVariable*&gt;&amp; dynObjs )
00859 {
00860         <a class="code" href="classDynamicVariable.html">DynamicVariable</a>* pnt2dyn = <span class="keyword">this</span>;
00861 
00862         <span class="comment">//Print the pointer value as an ID, then the "meat" gets printed later</span>
00863         xmlOutput &lt;&lt; <span class="stringliteral">"\t\t\t\t&lt;dv_type value=\"dvs\" /&gt;"</span> &lt;&lt; endl;
00864         xmlOutput &lt;&lt; <span class="stringliteral">"\t\t\t\t&lt;dv_ptr id=\""</span> &lt;&lt; (<span class="keywordtype">long</span>)pnt2dyn &lt;&lt; <span class="stringliteral">"\" /&gt;"</span> &lt;&lt; endl;
00865 
00866         <span class="comment">// Update dynamic variable list if necessary</span>
00867         list&lt;DynamicVariable*&gt;::const_iterator dynit;
00868         <span class="keywordflow">for</span>( dynit=dynObjs.begin(); dynit != dynObjs.end(); dynit++ )
00869         {
00870                 <span class="keywordflow">if</span>( (*dynit) == <span class="keyword">this</span> )
00871                         <span class="keywordflow">break</span>;
00872         }
00873         <span class="keywordflow">if</span>( dynit == dynObjs.end() ){
00874                 dynObjs.push_back( <span class="keyword">this</span> );
00875         }
00876 
00877 }
00878 
<a name="l00879"></a><a class="code" href="classDynamicVariableSequence.html#a29">00879</a> <span class="keywordtype">void</span> <a class="code" href="classDynamicVariableSequence.html#a29">DynamicVariableSequence::xml_read</a>(<a class="code" href="classXmlReader.html">XmlReader</a> *xml, <span class="keywordtype">char</span> *tagname)
00880 {
00881         printf(<span class="stringliteral">"IM HERE!"</span>);
00882         <a class="code" href="classXmlReader_1_1xmltag.html">XmlReader::xmltag</a> *tag=<span class="keyword">new</span> <a class="code" href="classXmlReader_1_1xmltag.html">XmlReader::xmltag</a>;
00883         <span class="keywordflow">while</span>(xml-&gt;<a class="code" href="classXmlReader.html#a4">readTag</a>(tag))
00884         {
00885                 <span class="keywordflow">if</span>(!strcmp(tag-&gt;<a class="code" href="classXmlReader_1_1xmltag.html#o0">name</a>,tagname) &amp;&amp; tag-&gt;<a class="code" href="classXmlReader_1_1xmltag.html#o2">isClosing</a>)
00886                         <span class="keywordflow">break</span>;
00887 
00888                 <span class="keywordflow">if</span>(!strcmp(tag-&gt;<a class="code" href="classXmlReader_1_1xmltag.html#o0">name</a>,<span class="stringliteral">"dv_type"</span>))
00889                 {
00890                         <span class="keywordflow">if</span>(strcmp(tag-&gt;<a class="code" href="classXmlReader_1_1xmltag.html#a3">getParamValue</a>(<span class="stringliteral">"value"</span>),<span class="stringliteral">"dvs"</span>))
00891                         {
00892                                 cout &lt;&lt; <span class="stringliteral">"OH GOD!  I WAS HOPING FOR dvs BUT I GOT "</span>&lt;&lt;tag-&gt;<a class="code" href="classXmlReader_1_1xmltag.html#a3">getParamValue</a>(<span class="stringliteral">"value"</span>)&lt;&lt;endl;
00893                         }
00894                 }
00895         }
00896         <span class="keyword">delete</span> tag;
00897 }
00898 
00899 <span class="comment">//----------------------------------------------------------------------------//</span>
00900 <span class="preprocessor">#endif //__DYNAMIC_VARIABLE_SEQUENCE_CPP</span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Mon Apr 25 13:18:11 2005 for LASS by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.4 </small></address>
</body>
</html>
